<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Python API &#8212; sphere 2.15-beta documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.15-beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="sphere 2.15-beta documentation" href="index.html" />
    <link rel="next" title="sphere internals" href="sphere_internals.html" />
    <link rel="prev" title="Fluid simulation and particle-fluid interaction" href="cfd.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sphere_internals.html" title="sphere internals"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cfd.html" title="Fluid simulation and particle-fluid interaction"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">sphere 2.15-beta documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="python-api">
<h1>Python API<a class="headerlink" href="#python-api" title="Permalink to this headline">¶</a></h1>
<p>The Python module <code class="docutils literal"><span class="pre">sphere</span></code> is intended as the main interface to the <code class="docutils literal"><span class="pre">sphere</span></code>
application. It is recommended to use this module for simulation setup,
simulation execution, and analysis of the simulation output data.</p>
<p>In order to use the API, the file <code class="docutils literal"><span class="pre">sphere.py</span></code> must be placed in the same
directory as the Python files.</p>
<div class="section" id="sample-usage">
<h2>Sample usage<a class="headerlink" href="#sample-usage" title="Permalink to this headline">¶</a></h2>
<p>Below is a simple, annotated example of how to setup, execute, and post-process
a <code class="docutils literal"><span class="pre">sphere</span></code> simulation.  The example is also found in the <code class="docutils literal"><span class="pre">python/</span></code> folder as
<code class="docutils literal"><span class="pre">collision.py</span></code>.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Example of two particles colliding.</span>
<span class="sd">Place script in sphere/python/ folder, and invoke with `python collision.py`</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Import the sphere module for setting up, running, and analyzing the</span>
<span class="c1"># experiment. We also need the numpy module when setting arrays in the sphere</span>
<span class="c1"># object.</span>
<span class="kn">import</span> <span class="nn">sphere</span>
<span class="kn">import</span> <span class="nn">numpy</span>


<span class="c1">### SIMULATION SETUP</span>

<span class="c1"># Create a sphere object with two preallocated particles and a simulation ID</span>
<span class="n">SB</span> <span class="o">=</span> <span class="n">sphere</span><span class="o">.</span><span class="n">sim</span><span class="p">(</span><span class="n">np</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sid</span> <span class="o">=</span> <span class="s1">&#39;collision&#39;</span><span class="p">)</span>

<span class="n">SB</span><span class="o">.</span><span class="n">radius</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># set radii to 0.3 m</span>

<span class="c1"># Define the positions of the two particles</span>
<span class="n">SB</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>   <span class="c1"># particle 1 (idx 0)</span>
<span class="n">SB</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">11.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>   <span class="c1"># particle 2 (idx 1)</span>

<span class="c1"># The default velocity is [0,0,0]. Slam particle 1 into particle 2 by defining</span>
<span class="c1"># a positive x velocity for particle 1.</span>
<span class="n">SB</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># Set the world limits and the particle sorting grid. The particles need to stay</span>
<span class="c1"># within the world limits for the entire simulation, otherwise it will stop!</span>
<span class="n">SB</span><span class="o">.</span><span class="n">initGridAndWorldsize</span><span class="p">(</span><span class="n">margin</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">)</span>

<span class="c1"># Define the temporal parameters, e.g. the total time (total) and the file</span>
<span class="c1"># output interval (file_dt), both in seconds</span>
<span class="n">SB</span><span class="o">.</span><span class="n">initTemporal</span><span class="p">(</span><span class="n">total</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">file_dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Using a &#39;dry&#39; run, the sphere main program will display important parameters.</span>
<span class="c1"># sphere will end after displaying these values.</span>
<span class="n">SB</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">dry</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>


<span class="c1">### RUNNING THE SIMULATION</span>

<span class="c1"># Start the simulation on the GPU from the sphere program</span>
<span class="n">SB</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>


<span class="c1">### ANALYSIS OF SIMULATION RESULTS</span>

<span class="c1"># Plot the system energy through time, image saved as collision-energy.png</span>
<span class="n">SB</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;energy&#39;</span><span class="p">)</span>

<span class="c1"># Render the particles using the built-in raytracer</span>
<span class="n">SB</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>

<span class="c1"># Alternative visualization using ParaView. See the documentation of</span>
<span class="c1"># ``sim.writeVTKall()`` for more information about displaying the</span>
<span class="c1"># particles in ParaView.</span>
<span class="n">SB</span><span class="o">.</span><span class="n">writeVTKall</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The full documentation of the <code class="docutils literal"><span class="pre">sphere</span></code> Python API can be found below.</p>
</div>
<div class="section" id="module-sphere">
<span id="the-sphere-module"></span><h2>The <code class="docutils literal"><span class="pre">sphere</span></code> module<a class="headerlink" href="#module-sphere" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="sphere.V_sphere">
<code class="descclassname">sphere.</code><code class="descname">V_sphere</code><span class="sig-paren">(</span><em>r</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.V_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the volume of a sphere with radius r</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The sphere volume [m^3]</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sphere.cleanup">
<code class="descclassname">sphere.</code><code class="descname">cleanup</code><span class="sig-paren">(</span><em>sim</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the input/output files and images belonging to the object simulation
ID from the <code class="docutils literal"><span class="pre">input/</span></code>, <code class="docutils literal"><span class="pre">output/</span></code> and <code class="docutils literal"><span class="pre">img_out/</span></code> folders.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>spherebin</strong> (<a class="reference internal" href="#sphere.sim" title="sphere.sim"><em>sim</em></a>) &#8211; A sim object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sphere.convert">
<code class="descclassname">sphere.</code><code class="descname">convert</code><span class="sig-paren">(</span><em>graphics_format='png'</em>, <em>folder='../img_out'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts all PPM images in img_out to graphics_format using Imagemagick. All
PPM images are subsequently removed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; Convert the images to this format</li>
<li><strong>folder</strong> (<em>str</em>) &#8211; The folder containing the PPM images to convert</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sphere.render">
<code class="descclassname">sphere.</code><code class="descname">render</code><span class="sig-paren">(</span><em>binary</em>, <em>method='pres'</em>, <em>max_val=1000.0</em>, <em>lower_cutoff=0.0</em>, <em>graphics_format='png'</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render target binary using the <code class="docutils literal"><span class="pre">sphere</span></code> raytracer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method</strong> (<em>str</em>) &#8211; The color visualization method to use for the particles.
Possible values are: &#8216;normal&#8217;: color all particles with the same
color, &#8216;pres&#8217;: color by pressure, &#8216;vel&#8217;: color by translational
velocity, &#8216;angvel&#8217;: color by rotational velocity, &#8216;xdisp&#8217;: color by
total displacement along the x-axis, &#8216;angpos&#8217;: color by angular
position.</li>
<li><strong>max_val</strong> (<em>float</em>) &#8211; The maximum value of the color bar</li>
<li><strong>lower_cutoff</strong> (<em>float</em>) &#8211; Do not render particles with a value below this
value, of the field selected by <code class="docutils literal"><span class="pre">method</span></code></li>
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; Convert the PPM images generated by the ray
tracer to this image format using Imagemagick</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show verbose information during ray tracing</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sphere.run">
<code class="descclassname">sphere.</code><code class="descname">run</code><span class="sig-paren">(</span><em>binary</em>, <em>verbose=True</em>, <em>hideinputfile=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute <code class="docutils literal"><span class="pre">sphere</span></code> with target binary file as input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>binary</strong> (<em>str</em>) &#8211; Input file for <code class="docutils literal"><span class="pre">sphere</span></code></li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show <code class="docutils literal"><span class="pre">sphere</span></code> output</li>
<li><strong>hideinputfile</strong> (<em>bool</em>) &#8211; Hide the input file</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="sphere.sim">
<em class="property">class </em><code class="descclassname">sphere.</code><code class="descname">sim</code><span class="sig-paren">(</span><em>sid='unnamed'</em>, <em>np=0</em>, <em>nd=3</em>, <em>nw=0</em>, <em>fluid=False</em>, <em>cfd_solver=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Class containing all <code class="docutils literal"><span class="pre">sphere</span></code> data.</p>
<p>Contains functions for reading and writing binaries, as well as simulation
setup and data analysis. Most arrays are initialized to default values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>np</strong> (<em>int</em>) &#8211; The number of particles to allocate memory for (default = 1)</li>
<li><strong>nd</strong> (<em>int</em>) &#8211; The number of spatial dimensions (default = 3). Note that 2D and
1D simulations currently are not possible.</li>
<li><strong>nw</strong> (<em>int</em>) &#8211; The number of dynamic walls (default = 1)</li>
<li><strong>sid</strong> (<em>str</em>) &#8211; The simulation id (default = &#8216;unnamed&#8217;). The simulation files
will be written with this base name.</li>
<li><strong>fluid</strong> (<em>bool</em>) &#8211; Setup fluid simulation (default = False)</li>
<li><strong>cfd_solver</strong> (<em>int</em>) &#8211; Fluid solver to use if fluid == True. 0: Navier-Stokes
(default), 1: Darcy.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="sphere.sim.ReynoldsNumber">
<code class="descname">ReynoldsNumber</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.ReynoldsNumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the per-cell Reynolds number by: Re = rho * ||v_f|| * dx/mu.
This value is returned and also stored in <cite>self.Re</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Reynolds number</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Numpy array with dimensions like the fluid grid</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.acceleration">
<code class="descname">acceleration</code><span class="sig-paren">(</span><em>idx=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.acceleration" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the acceleration of one or more particles, selected by their
index. If the index is equal to -1 (default value), all accelerations
are returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int, list or numpy.array</em>) &#8211; Index or index range of particles</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">n-by-3 matrix of acceleration(s)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.adaptiveGrid">
<code class="descname">adaptiveGrid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.adaptiveGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the height of the fluid grid to automatically readjust to the
height of the granular assemblage, as dictated by the position of the
top wall.  This will readjust <cite>self.L[2]</cite> during the simulation to
equal the position of the top wall <cite>self.w_x[0]</cite>.</p>
<p>See also <a class="reference internal" href="#sphere.sim.staticGrid" title="sphere.sim.staticGrid"><code class="xref py py-func docutils literal"><span class="pre">staticGrid()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.addParticle">
<code class="descname">addParticle</code><span class="sig-paren">(</span><em>x</em>, <em>radius</em>, <em>xyzsum=array([ 0.</em>, <em>0.</em>, <em>0.])</em>, <em>vel=array([ 0.</em>, <em>0.</em>, <em>0.])</em>, <em>fixvel=array([ 0.])</em>, <em>force=array([ 0.</em>, <em>0.</em>, <em>0.])</em>, <em>angpos=array([ 0.</em>, <em>0.</em>, <em>0.])</em>, <em>angvel=array([ 0.</em>, <em>0.</em>, <em>0.])</em>, <em>torque=array([ 0.</em>, <em>0.</em>, <em>0.])</em>, <em>es_dot=array([ 0.])</em>, <em>es=array([ 0.])</em>, <em>ev_dot=array([ 0.])</em>, <em>ev=array([ 0.])</em>, <em>p=array([ 0.])</em>, <em>color=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.addParticle" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a single particle to the simulation object. The only required
parameters are the position (x) and the radius (radius).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>numpy.array</em>) &#8211; A vector pointing to the particle center coordinate.</li>
<li><strong>radius</strong> (<em>float</em>) &#8211; The particle radius</li>
<li><strong>vel</strong> (<em>numpy.array</em>) &#8211; The particle linear velocity (default = [0,0,0])</li>
<li><strong>fixvel</strong> (<em>float</em>) &#8211; 0: Do not fix particle velocity (default), 1: Fix
horizontal linear velocity, -1: Fix horizontal and vertical linear
velocity</li>
<li><strong>angpos</strong> (<em>numpy.array</em>) &#8211; The particle angular position (default = [0,0,0])</li>
<li><strong>angvel</strong> (<em>numpy.array</em>) &#8211; The particle angular velocity (default = [0,0,0])</li>
<li><strong>torque</strong> (<em>numpy.array</em>) &#8211; The particle torque (default = [0,0,0])</li>
<li><strong>es_dot</strong> (<em>float</em>) &#8211; The particle shear energy loss rate (default = 0)</li>
<li><strong>es</strong> (<em>float</em>) &#8211; The particle shear energy loss (default = 0)</li>
<li><strong>ev_dot</strong> (<em>float</em>) &#8211; The particle viscous energy rate loss (default = 0)</li>
<li><strong>ev</strong> (<em>float</em>) &#8211; The particle viscous energy loss (default = 0)</li>
<li><strong>p</strong> (<em>float</em>) &#8211; The particle pressure (default = 0)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.adjustUpperWall">
<code class="descname">adjustUpperWall</code><span class="sig-paren">(</span><em>z_adjust=1.1</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.adjustUpperWall" title="Permalink to this definition">¶</a></dt>
<dd><p>Included for legacy purposes, calls <a class="reference internal" href="#sphere.sim.adjustWall" title="sphere.sim.adjustWall"><code class="xref py py-func docutils literal"><span class="pre">adjustWall()</span></code></a> with <code class="docutils literal"><span class="pre">idx=0</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>z_adjust</strong> (<em>float</em>) &#8211; Increase the world and grid size by this amount to
allow for wall movement.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.adjustWall">
<code class="descname">adjustWall</code><span class="sig-paren">(</span><em>idx</em>, <em>adjust=1.1</em>, <em>wall_mass_factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.adjustWall" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust grid and dynamic wall to max. particle position. The wall
thickness will by standard equal the maximum particle diameter. The
density equals the particle density, and the wall size is equal to the
width and depth of the simulation domain (<cite>self.L[0]</cite> and <cite>self.L[1]</cite>).
The total wall mass can be linearly scaled by the <cite>wall_mass_factor</cite>
parameter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">idx: The wall to adjust. 0 = +z, upper wall (default), 1 = -x,
left wall, 2 = +x, right wall, 3 = -y, front wall, 4 = +y, back
wall.</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>z_adjust</strong> (<em>float</em>) &#8211; Increase the world and grid size by this amount to
allow for wall movement.</td>
</tr>
</tbody>
</table>
<p>:param</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.bond">
<code class="descname">bond</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a bond between particles with index i and j</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i</strong> (<em>int</em>) &#8211; Index of first particle in bond</li>
<li><strong>j</strong> (<em>int</em>) &#8211; Index of second particle in bond</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.bondsRose">
<code class="descname">bondsRose</code><span class="sig-paren">(</span><em>graphics_format='pdf'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.bondsRose" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the trend and plunge angles of the bond pairs in a rose plot.
The plot is saved in the current folder as
&#8216;bonds-&lt;simulation id&gt;-rose.&lt;graphics_format&gt;&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.bulkPorosity">
<code class="descname">bulkPorosity</code><span class="sig-paren">(</span><em>trim=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.bulkPorosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the bulk porosity of the particle assemblage.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>trim</strong> (<em>bool</em>) &#8211; Trim the total volume to the smallest axis-parallel cube
containing all particles.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The bulk porosity, in [0:1]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.cellSize">
<code class="descname">cellSize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.cellSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the particle sorting (and fluid) cell dimensions.
These values are stored in <cite>self.dx</cite> and are NOT returned.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.checkerboardColors">
<code class="descname">checkerboardColors</code><span class="sig-paren">(</span><em>nx=6</em>, <em>ny=6</em>, <em>nz=6</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.checkerboardColors" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign checkerboard color values to the particles in an orthogonal grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nx</strong> (<em>int</em>) &#8211; Number of color values along the x axis</li>
<li><strong>ny</strong> (<em>int</em>) &#8211; Number of color values along the y ayis</li>
<li><strong>nz</strong> (<em>int</em>) &#8211; Number of color values along the z azis</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.cleanup">
<code class="descname">cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the input/output files and images belonging to the object
simulation ID from the <code class="docutils literal"><span class="pre">input/</span></code>, <code class="docutils literal"><span class="pre">output/</span></code> and <code class="docutils literal"><span class="pre">img_out/</span></code> folders.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.consolidate">
<code class="descname">consolidate</code><span class="sig-paren">(</span><em>normal_stress=10000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.consolidate" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup consolidation experiment. Specify the upper wall normal stress in
Pascal, default value is 10 kPa.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>normal_stress</strong> (<em>float</em>) &#8211; The normal stress to apply from the upper wall</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.contactModel">
<code class="descname">contactModel</code><span class="sig-paren">(</span><em>contactmodel</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.contactModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Define which contact model to use for the tangential component of
particle-particle interactions. The elastic-viscous-frictional contact
model (2) is considered to be the most realistic contact model, while
the viscous-frictional contact model is significantly faster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>contactmodel</strong> (<em>int</em>) &#8211; The type of tangential contact model to use
(visco-frictional = 1, elasto-visco-frictional = 2)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.contactParticleArea">
<code class="descname">contactParticleArea</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.contactParticleArea" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the average area of an two particles in an inter-particle contact.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>int or array of ints</em>) &#8211; Index of first particle</li>
<li><strong>j</strong> (<em>int or array of ints</em>) &#8211; Index of second particle</li>
<li><strong>d</strong> (<em>float or array of floats</em>) &#8211; Overlap distance</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Contact area [m*m]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float or array of floats</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.contactSurfaceArea">
<code class="descname">contactSurfaceArea</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>overlap</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.contactSurfaceArea" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the contact surface area of an inter-particle contact.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>int or array of ints</em>) &#8211; Index of first particle</li>
<li><strong>j</strong> (<em>int or array of ints</em>) &#8211; Index of second particle</li>
<li><strong>d</strong> (<em>float or array of floats</em>) &#8211; Overlap distance</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Contact area [m*m]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float or array of floats</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.convergence">
<code class="descname">convergence</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the convergence evolution in the CFD solver. The values are stored
in <cite>self.conv</cite> with iteration number in the first column and iteration
count in the second column.</p>
<p>See also: <a class="reference internal" href="#sphere.sim.plotConvergence" title="sphere.sim.plotConvergence"><code class="xref py py-func docutils literal"><span class="pre">plotConvergence()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.createBondPair">
<code class="descname">createBondPair</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>spacing=-0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.createBondPair" title="Permalink to this definition">¶</a></dt>
<dd><p>Bond particles i and j. Particle j is moved adjacent to particle i,
and oriented randomly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i</strong> (<em>int</em>) &#8211; Index of first particle in bond</li>
<li><strong>j</strong> (<em>int</em>) &#8211; Index of second particle in bond</li>
<li><strong>spacing</strong> (<em>float</em>) &#8211; The inter-particle distance prescribed. Positive
values result in a inter-particle distance, negative equal an
overlap. The value is relative to the sum of the two radii.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.currentNormalStress">
<code class="descname">currentNormalStress</code><span class="sig-paren">(</span><em>type='defined'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.currentNormalStress" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the current magnitude of the defined or effective top wall
normal stress.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>type</strong> (<em>str</em>) &#8211; Find the &#8216;defined&#8217; (default) or &#8216;effective&#8217; normal stress</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The current top wall normal stress in Pascal</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.currentTime">
<code class="descname">currentTime</code><span class="sig-paren">(</span><em>value=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.currentTime" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the current time. If called without arguments the current
time is returned. If a new time is passed in the &#8216;value&#8217; argument, the
time is written to the object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>float</em>) &#8211; The new current time</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The current time</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.defaultParams">
<code class="descname">defaultParams</code><span class="sig-paren">(</span><em>mu_s=0.5</em>, <em>mu_d=0.5</em>, <em>mu_r=0.0</em>, <em>rho=2600</em>, <em>k_n=1160000000.0</em>, <em>k_t=1160000000.0</em>, <em>k_r=0</em>, <em>gamma_n=0.0</em>, <em>gamma_t=0.0</em>, <em>gamma_r=0.0</em>, <em>gamma_wn=10000.0</em>, <em>gamma_wt=10000.0</em>, <em>capillaryCohesion=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.defaultParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize particle parameters to default values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mu_s</strong> (<em>float</em>) &#8211; The coefficient of static friction between particles [-]</li>
<li><strong>mu_d</strong> (<em>float</em>) &#8211; The coefficient of dynamic friction between particles [-]</li>
<li><strong>rho</strong> (<em>float</em>) &#8211; The density of the particle material [kg/(m^3)]</li>
<li><strong>k_n</strong> (<em>float</em>) &#8211; The normal stiffness of the particles [N/m]</li>
<li><strong>k_t</strong> (<em>float</em>) &#8211; The tangential stiffness of the particles [N/m]</li>
<li><strong>k_r</strong> (<em>float</em>) &#8211; The rolling stiffness of the particles [N/rad] <em>Parameter
not used</em></li>
<li><strong>gamma_n</strong> (<em>float</em>) &#8211; Particle-particle contact normal viscosity [Ns/m]</li>
<li><strong>gamma_t</strong> (<em>float</em>) &#8211; Particle-particle contact tangential viscosity [Ns/m]</li>
<li><strong>gamma_r</strong> (<em>float</em>) &#8211; Particle-particle contact rolling viscosity <em>Parameter
not used</em></li>
<li><strong>gamma_wn</strong> (<em>float</em>) &#8211; Wall-particle contact normal viscosity [Ns/m]</li>
<li><strong>gamma_wt</strong> (<em>float</em>) &#8211; Wall-particle contact tangential viscosity [Ns/m]</li>
<li><strong>capillaryCohesion</strong> (<em>int</em>) &#8211; Enable particle-particle capillary cohesion
interaction model (0 = no (default), 1 = yes)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.defineWorldBoundaries">
<code class="descname">defineWorldBoundaries</code><span class="sig-paren">(</span><em>L, origo=[0.0, 0.0, 0.0], dx=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.defineWorldBoundaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the boundaries of the world. Particles will only be able to interact
within this domain. With dynamic walls, allow space for expansions.
<em>Important</em>: The particle radii have to be set beforehand. The world
edges act as static walls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>L</strong> (<em>numpy.array</em>) &#8211; The upper boundary of the domain [m]</li>
<li><strong>origo</strong> (<em>numpy.array</em>) &#8211; The lower boundary of the domain [m]. Negative values
won&#8217;t work. Default = [0.0, 0.0, 0.0].</li>
<li><strong>dx</strong> (<em>float</em>) &#8211; The cell width in any direction. If the default value is used
(-1), the cell width is calculated to fit the largest particle.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.deleteAllParticles">
<code class="descname">deleteAllParticles</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.deleteAllParticles" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes all particles in the simulation object.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.deleteParticle">
<code class="descname">deleteParticle</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.deleteParticle" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete particle(s) with index <code class="docutils literal"><span class="pre">i</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>i</strong> (<em>int, list or numpy.array</em>) &#8211; One or more particle indexes to delete</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.disableFluidPressureModulation">
<code class="descname">disableFluidPressureModulation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.disableFluidPressureModulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters for the sine wave modulating the fluid pressures
at the top boundary to zero.</p>
<p>See also: <a class="reference internal" href="#sphere.sim.setFluidPressureModulation" title="sphere.sim.setFluidPressureModulation"><code class="xref py py-func docutils literal"><span class="pre">setFluidPressureModulation()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.disableTopWallNormalStressModulation">
<code class="descname">disableTopWallNormalStressModulation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.disableTopWallNormalStressModulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters for the sine wave modulating the normal stress
at the top dynamic wall to zero.</p>
<p>See also: <a class="reference internal" href="#sphere.sim.setTopWallNormalStressModulation" title="sphere.sim.setTopWallNormalStressModulation"><code class="xref py py-func docutils literal"><span class="pre">setTopWallNormalStressModulation()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.dry">
<code class="descname">dry</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.dry" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the simulation to be dry (no fluids).</p>
<p>See also <a class="reference internal" href="#sphere.sim.wet" title="sphere.sim.wet"><code class="xref py py-func docutils literal"><span class="pre">wet()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.energy">
<code class="descname">energy</code><span class="sig-paren">(</span><em>method</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sum of the energy components of all particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>method</strong> (<em>str</em>) &#8211; The type of energy to return. Possible values are &#8216;pot&#8217;
for potential energy [J], &#8216;kin&#8217; for kinetic energy [J], &#8216;rot&#8217; for
rotational energy [J], &#8216;shear&#8217; for energy lost by friction,
&#8216;shearrate&#8217; for the rate of frictional energy loss [W], &#8216;visc_n&#8217; for
viscous losses normal to the contact [J], &#8216;visc_n_rate&#8217; for the rate
of viscous losses normal to the contact [W], and finally &#8216;bondpot&#8217;
for the potential energy stored in bonds [J]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The value of the selected energy type</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.findAllAverageParticlePairAreas">
<code class="descname">findAllAverageParticlePairAreas</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.findAllAverageParticlePairAreas" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the average area of an inter-particle contact. This
function requires a prior call to <a class="reference internal" href="#sphere.sim.findOverlaps" title="sphere.sim.findOverlaps"><code class="xref py py-func docutils literal"><span class="pre">findOverlaps()</span></code></a> as it reads
from the <code class="docutils literal"><span class="pre">self.pairs</span></code> and <code class="docutils literal"><span class="pre">self.overlaps</span></code> arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Array of contact surface areas</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array of floats</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.findAllContactSurfaceAreas">
<code class="descname">findAllContactSurfaceAreas</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.findAllContactSurfaceAreas" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the contact surface area of an inter-particle contact. This
function requires a prior call to <a class="reference internal" href="#sphere.sim.findOverlaps" title="sphere.sim.findOverlaps"><code class="xref py py-func docutils literal"><span class="pre">findOverlaps()</span></code></a> as it reads
from the <code class="docutils literal"><span class="pre">self.pairs</span></code> and <code class="docutils literal"><span class="pre">self.overlaps</span></code> arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Array of contact surface areas</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array of floats</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.findContactStresses">
<code class="descname">findContactStresses</code><span class="sig-paren">(</span><em>area='average'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.findContactStresses" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all particle-particle uniaxial normal stresses (by first calling
<a class="reference internal" href="#sphere.sim.findNormalForces" title="sphere.sim.findNormalForces"><code class="xref py py-func docutils literal"><span class="pre">findNormalForces()</span></code></a>) and calculating the stress magnitudes by
dividing the normal force magnitude with the average particle area
(&#8216;average&#8217;) or by the contact surface area (&#8216;contact&#8217;).</p>
<p>The result is saved in <code class="docutils literal"><span class="pre">self.sigma_contacts</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>area</strong> (<em>str</em>) &#8211; Area to use: &#8216;average&#8217; (default) or &#8216;contact&#8217;</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.findNormalForces" title="sphere.sim.findNormalForces"><code class="xref py py-func docutils literal"><span class="pre">findNormalForces()</span></code></a> and <a class="reference internal" href="#sphere.sim.findOverlaps" title="sphere.sim.findOverlaps"><code class="xref py py-func docutils literal"><span class="pre">findOverlaps()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.findCoordinationNumber">
<code class="descname">findCoordinationNumber</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.findCoordinationNumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the coordination number (the average number of contacts per
particle). Requires a previous call to <a class="reference internal" href="#sphere.sim.findOverlaps" title="sphere.sim.findOverlaps"><code class="xref py py-func docutils literal"><span class="pre">findOverlaps()</span></code></a>. Values
are stored in <code class="docutils literal"><span class="pre">self.coordinationnumber</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.findHydraulicConductivities">
<code class="descname">findHydraulicConductivities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.findHydraulicConductivities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the hydrological conductivities from the Kozeny-Carman
relationship. These values are only relevant when the Darcy solver is
used (<cite>self.cfd_solver = 1</cite>). The permeability pre-factor <cite>self.k_c</cite>
and the assemblage porosities must be set beforehand. The former values
are set if a file from the <cite>output/</cite> folder is read using
<cite>self.readbin</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.findLoadedContacts">
<code class="descname">findLoadedContacts</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.findLoadedContacts" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the indices of contact pairs where the contact stress magnitude
exceeds or is equal to a specified threshold value. This function calls
<a class="reference internal" href="#sphere.sim.findContactStresses" title="sphere.sim.findContactStresses"><code class="xref py py-func docutils literal"><span class="pre">findContactStresses()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>threshold</strong> (<em>float</em>) &#8211; Threshold contact stress [Pa]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Array of contact indices</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array of ints</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.findMeanCoordinationNumber">
<code class="descname">findMeanCoordinationNumber</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.findMeanCoordinationNumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordination number (the average number of contacts per
particle). Requires a previous call to <a class="reference internal" href="#sphere.sim.findOverlaps" title="sphere.sim.findOverlaps"><code class="xref py py-func docutils literal"><span class="pre">findOverlaps()</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The mean particle coordination number</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.findNormalForces">
<code class="descname">findNormalForces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.findNormalForces" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all particle-particle overlaps (by first calling
<a class="reference internal" href="#sphere.sim.findOverlaps" title="sphere.sim.findOverlaps"><code class="xref py py-func docutils literal"><span class="pre">findOverlaps()</span></code></a>) and calculating the normal magnitude by
multiplying the overlaps with the elastic stiffness <code class="docutils literal"><span class="pre">self.k_n</span></code>.</p>
<p>The result is saved in <code class="docutils literal"><span class="pre">self.f_n_magn</span></code>.</p>
<p>See also: <a class="reference internal" href="#sphere.sim.findOverlaps" title="sphere.sim.findOverlaps"><code class="xref py py-func docutils literal"><span class="pre">findOverlaps()</span></code></a> and <a class="reference internal" href="#sphere.sim.findContactStresses" title="sphere.sim.findContactStresses"><code class="xref py py-func docutils literal"><span class="pre">findContactStresses()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.findOverlaps">
<code class="descname">findOverlaps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.findOverlaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all particle-particle overlaps by a n^2 contact search, which is
done in C++. The particle pair indexes and the distance of the overlaps
is saved in the object itself as the <code class="docutils literal"><span class="pre">.pairs</span></code> and <code class="docutils literal"><span class="pre">.overlaps</span></code>
members.</p>
<p>See also: <a class="reference internal" href="#sphere.sim.findNormalForces" title="sphere.sim.findNormalForces"><code class="xref py py-func docutils literal"><span class="pre">findNormalForces()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.findPermeabilities">
<code class="descname">findPermeabilities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.findPermeabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the hydrological permeabilities from the Kozeny-Carman
relationship. These values are only relevant when the Darcy solver is
used (<cite>self.cfd_solver = 1</cite>). The permeability pre-factor <cite>self.k_c</cite>
and the assemblage porosities must be set beforehand. The former values
are set if a file from the <cite>output/</cite> folder is read using
<cite>self.readbin</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.forcechains">
<code class="descname">forcechains</code><span class="sig-paren">(</span><em>lc=200.0</em>, <em>uc=650.0</em>, <em>outformat='png'</em>, <em>disp='2d'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.forcechains" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualizes the force chains in the system from the magnitude of the
normal contact forces, and produces an image of them. Warning: Will
segfault if no contacts are found.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lc</strong> (<em>float</em>) &#8211; Lower cutoff of contact forces. Contacts below are not
visualized</li>
<li><strong>uc</strong> (<em>float</em>) &#8211; Upper cutoff of contact forces. Contacts above are
visualized with this value</li>
<li><strong>outformat</strong> (<em>str</em>) &#8211; Format of output image. Possible values are
&#8216;interactive&#8217;, &#8216;png&#8217;, &#8216;epslatex&#8217;, &#8216;epslatex-color&#8217;</li>
<li><strong>disp</strong> (<em>str</em>) &#8211; Display forcechains in &#8216;2d&#8217; or &#8216;3d&#8217;</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.forcechainsRose">
<code class="descname">forcechainsRose</code><span class="sig-paren">(</span><em>lower_limit=0.25</em>, <em>graphics_format='pdf'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.forcechainsRose" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize trend and plunge angles of the strongest force chains in a
rose plot. The plots are saved in the current folder with the name
&#8216;fc-&lt;simulation id&gt;-rose.pdf&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lower_limit</strong> (<em>float</em>) &#8211; Do not visualize force chains below this relative
contact force magnitude, in ]0;1[</li>
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.frictionalEnergy">
<code class="descname">frictionalEnergy</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.frictionalEnergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the frictional dissipated energy for a particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int</em>) &#8211; Particle index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The frictional energy lost of the particle [J]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.generateBimodalRadii">
<code class="descname">generateBimodalRadii</code><span class="sig-paren">(</span><em>r_small=0.005</em>, <em>r_large=0.05</em>, <em>ratio=0.2</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.generateBimodalRadii" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw random radii from two distinct sizes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>r_small</strong> (<em>float</em>) &#8211; Radii of small population [m], in ]0;r_large[</li>
<li><strong>r_large</strong> (<em>float</em>) &#8211; Radii of large population [m], in ]r_small;inf[</li>
<li><strong>ratio</strong> (<em>float</em>) &#8211; Approximate volumetric ratio between the two
populations (large/small).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.generateRadii" title="sphere.sim.generateRadii"><code class="xref py py-func docutils literal"><span class="pre">generateRadii()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.generateRadii">
<code class="descname">generateRadii</code><span class="sig-paren">(</span><em>psd='logn'</em>, <em>mean=0.00044</em>, <em>variance=8.8e-09</em>, <em>histogram=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.generateRadii" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw random particle radii from a selected probability distribution.
The larger the variance of radii is, the slower the computations will
run. The reason is two-fold: The smallest particle dictates the time
step length, where smaller particles cause shorter time steps. At the
same time, the largest particle determines the sorting cell size, where
larger particles cause larger cells. Larger cells are likely to contain
more particles, causing more contact checks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>psd</strong> (<em>str</em>) &#8211; The particle side distribution. One possible value is
<code class="docutils literal"><span class="pre">logn</span></code>, which is a log-normal probability distribution, suitable
for approximating well-sorted, coarse sediments. The other possible
value is <code class="docutils literal"><span class="pre">uni</span></code>, which is a uniform distribution from
<code class="docutils literal"><span class="pre">mean</span> <span class="pre">-</span> <span class="pre">variance</span></code> to <code class="docutils literal"><span class="pre">mean</span> <span class="pre">+</span> <span class="pre">variance</span></code>.</li>
<li><strong>mean</strong> (<em>float</em>) &#8211; The mean radius [m] (default = 440e-6 m)</li>
<li><strong>variance</strong> (<em>float</em>) &#8211; The variance in the probability distribution
[m].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.generateBimodalRadii" title="sphere.sim.generateBimodalRadii"><code class="xref py py-func docutils literal"><span class="pre">generateBimodalRadii()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.hydraulicConductivity">
<code class="descname">hydraulicConductivity</code><span class="sig-paren">(</span><em>phi=0.35</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.hydraulicConductivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the hydraulic conductivity (K) [m/s] from the permeability
prefactor and a chosen porosity.  This value is stored in <cite>self.K_c</cite>.
This function only works for the Darcy solver (<cite>self.cfd_solver == 1</cite>)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>float</em>) &#8211; The porosity to use in the Kozeny-Carman relationship</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The hydraulic conductivity [m/s]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.hydraulicDiffusivity">
<code class="descname">hydraulicDiffusivity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.hydraulicDiffusivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the hydraulic diffusivity (D) [m*m/s]. The result is stored in
<cite>self.D</cite>. This function only works for the Darcy solver
(<cite>self.cfd_solver[0] == 1</cite>)</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.hydraulicPermeability">
<code class="descname">hydraulicPermeability</code><span class="sig-paren">(</span><em>phi_min=0.3</em>, <em>phi_max=0.99</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.hydraulicPermeability" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the hydraulic permeability (k) [m*m] from the Kozeny-Carman
relationship, using the permeability prefactor (<cite>self.k_c</cite>), and the
range of valid porosities set in <cite>src/darcy.cuh</cite>, by default in the
range 0.1 to 0.9.</p>
<p>This function is only valid for the Darcy solver (<cite>self.cfd_solver ==
1</cite>).</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.id">
<code class="descname">id</code><span class="sig-paren">(</span><em>sid=''</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns or sets the simulation id/name, which is used to identify
simulation files in the output folders.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sid</strong> (<em>str</em>) &#8211; The desired simulation id. If left blank the current
simulation id will be returned.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The current simulation id if no new value is set.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.idAppend">
<code class="descname">idAppend</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.idAppend" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a string to the simulation id/name, which is used to identify
simulation files in the output folders.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>string</strong> (<em>str</em>) &#8211; The string to append to the simulation id (<cite>self.sid</cite>).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.inertiaParameterPlanarShear">
<code class="descname">inertiaParameterPlanarShear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.inertiaParameterPlanarShear" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the inertia parameter $I$ during planar shear
proposed by GDR-MiDi 2004.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The value of $I$</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.shearStrainRate" title="sphere.sim.shearStrainRate"><code class="xref py py-func docutils literal"><span class="pre">shearStrainRate()</span></code></a> and <a class="reference internal" href="#sphere.sim.shearVel" title="sphere.sim.shearVel"><code class="xref py py-func docutils literal"><span class="pre">shearVel()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.initFluid">
<code class="descname">initFluid</code><span class="sig-paren">(</span><em>mu=0.00089</em>, <em>rho=1000.0</em>, <em>p=0.0</em>, <em>hydrostatic=False</em>, <em>cfd_solver=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.initFluid" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the fluid arrays and the fluid viscosity. The default value
of <code class="docutils literal"><span class="pre">mu</span></code> equals the dynamic viscosity of water at 25 degrees Celcius.
The value for water at 0 degrees Celcius is 17.87e-4 kg/(m*s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mu</strong> (<em>float</em>) &#8211; The fluid dynamic viscosity [kg/(m*s)]</li>
<li><strong>rho</strong> (<em>float</em>) &#8211; The fluid density [kg/(m^3)]</li>
<li><strong>p</strong> &#8211; The hydraulic pressure to initialize the cells to. If the
parameter <cite>hydrostatic</cite> is set to <cite>True</cite>, this value will apply to
the fluid cells at the top</li>
<li><strong>hydrostatic</strong> (<em>bool</em>) &#8211; Initialize the fluid pressures to the hydrostatic
pressure distribution. A pressure gradient with depth is only
created if a gravitational acceleration along <img class="math" src="_images/math/683f2dd9129a91d21aaf1c04afa6f78b39d4cb0a.png" alt="z"/> previously
has been specified</li>
<li><strong>cfd_solver</strong> (<em>int</em>) &#8211; Solver to use for the computational fluid dynamics.
Accepted values: 0 (Navier Stokes, default) and 1 (Darcy).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.initGrid">
<code class="descname">initGrid</code><span class="sig-paren">(</span><em>dx=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.initGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize grid suitable for the particle positions set previously.
The margin parameter adjusts the distance (in no. of max. radii)
from the particle boundaries.
<em>Important</em>: The particle radii have to be set beforehand if the cell
width isn&#8217;t specified by <cite>dx</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dx</strong> (<em>float</em>) &#8211; The cell width in any direction. If the default value is used
(-1), the cell width is calculated to fit the largest particle.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.initGridAndWorldsize">
<code class="descname">initGridAndWorldsize</code><span class="sig-paren">(</span><em>margin=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.initGridAndWorldsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize grid suitable for the particle positions set previously.
The margin parameter adjusts the distance (in no. of max. radii)
from the particle boundaries. If the upper wall is dynamic, it is placed
at the top boundary of the world.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>margin</strong> (<em>float</em>) &#8211; Distance to world boundary in no. of max. particle radii</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.initGridPos">
<code class="descname">initGridPos</code><span class="sig-paren">(</span><em>gridnum=array([12</em>, <em>12</em>, <em>36])</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.initGridPos" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize particle positions in loose, cubic configuration.
<code class="docutils literal"><span class="pre">gridnum</span></code> is the number of cells in the x, y and z directions.
<em>Important</em>: The particle radii and the boundary conditions (periodic or
not) for the x and y boundaries have to be set beforehand.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>gridnum</strong> (<em>numpy.array</em>) &#8211; The number of particles in x, y and z directions</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.initRandomGridPos">
<code class="descname">initRandomGridPos</code><span class="sig-paren">(</span><em>gridnum=array([12</em>, <em>12</em>, <em>32])</em>, <em>padding=2.1</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.initRandomGridPos" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize particle positions in loose, cubic configuration with some
variance. <code class="docutils literal"><span class="pre">gridnum</span></code> is the number of cells in the x, y and z
directions.  <em>Important</em>: The particle radii and the boundary conditions
(periodic or not) for the x and y boundaries have to be set beforehand.
The world size and grid height (in the z direction) is readjusted to fit
the particle positions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>gridnum</strong> (<em>numpy.array</em>) &#8211; The number of particles in x, y and z directions</li>
<li><strong>padding</strong> (<em>float</em>) &#8211; Increase distance between particles in x, y and z
directions with this multiplier. Large values create more random
packings.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.initRandomPos">
<code class="descname">initRandomPos</code><span class="sig-paren">(</span><em>gridnum=array([12</em>, <em>12</em>, <em>36])</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.initRandomPos" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize particle positions in completely random configuration. Radii
<em>must</em> be set beforehand. If the x and y boundaries are set as periodic,
the particle centers will be placed all the way to the edge. On regular,
non-periodic boundaries, the particles are restrained at the edges to
make space for their radii within the bounding box.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>gridnum</strong> (<em>numpy.array</em>) &#8211; The number of sorting cells in each spatial direction
(default = [12, 12, 36])</li>
<li><strong>dx</strong> (<em>float</em>) &#8211; The cell width in any direction. If the default value is used
(-1), the cell width is calculated to fit the largest particle.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.initTemporal">
<code class="descname">initTemporal</code><span class="sig-paren">(</span><em>total</em>, <em>current=0.0</em>, <em>file_dt=0.05</em>, <em>step_count=0</em>, <em>dt=-1</em>, <em>epsilon=0.01</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.initTemporal" title="Permalink to this definition">¶</a></dt>
<dd><p>Set temporal parameters for the simulation. <em>Important</em>: Particle radii,
physical parameters, and the optional fluid grid need to be set prior to
these if the computational time step (dt) isn&#8217;t set explicitly. If the
parameter <cite>dt</cite> is the default value (-1), the function will estimate the
best time step length. The value of the computational time step for the
DEM is checked for stability in the CFD solution if fluid simulation is
included.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>total</strong> (<em>float</em>) &#8211; The time at which to end the simulation [s]</li>
<li><strong>current</strong> &#8211; The current time [s] (default = 0.0 s)</li>
<li><strong>file_dt</strong> &#8211; The interval between output files [s] (default = 0.05 s)</li>
<li><strong>dt</strong> &#8211; The computational time step length [s]</li>
<li><strong>epsilon</strong> (<em>float</em>) &#8211; Time step multiplier (default = 0.01)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Step_count:</th><td class="field-body"><p class="first last">The number of the first output file (default = 0)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.kineticEnergy">
<code class="descname">kineticEnergy</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.kineticEnergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the (linear) kinetic energy for a particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int</em>) &#8211; Particle index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The kinetic energy of the particle [J]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.largestFluidTimeStep">
<code class="descname">largestFluidTimeStep</code><span class="sig-paren">(</span><em>safety=0.5</em>, <em>v_max=-1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.largestFluidTimeStep" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds and returns the largest time step in the fluid phase by von
Neumann and Courant-Friedrichs-Lewy analysis given the current
velocities. This ensures stability in the diffusive and advective parts
of the momentum equation.</p>
<p>The value of the time step decreases with increasing fluid viscosity
(<cite>self.mu</cite>), and increases with fluid cell size (<cite>self.L/self.num</cite>)</p>
<p>and fluid velocities (<cite>self.v_f</cite>)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>safety</strong> (<em>float</em>) &#8211; Safety factor which is multiplied to the largest time
step.</li>
<li><strong>v_max</strong> (<em>float</em>) &#8211; The largest anticipated absolute fluid velocity [m/s]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The largest timestep stable for the current fluid state.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.largestMass">
<code class="descname">largestMass</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.largestMass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mass of the heaviest particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int</em>) &#8211; Particle index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The mass of the particle [kg]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.mass">
<code class="descname">mass</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mass of a particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int</em>) &#8211; Particle index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The mass of the particle [kg]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.momentOfInertia">
<code class="descname">momentOfInertia</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.momentOfInertia" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the moment of inertia of a particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int</em>) &#8211; Particle index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The moment of inertia [kg*m^2]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.momentum">
<code class="descname">momentum</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the momentum (m*v) of a particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int</em>) &#8211; The particle index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The particle momentum [N*s]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.normalBoundariesXY">
<code class="descname">normalBoundariesXY</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.normalBoundariesXY" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the x and y boundary conditions to be static walls.</p>
<p>See also <a class="reference internal" href="#sphere.sim.periodicBoundariesXY" title="sphere.sim.periodicBoundariesXY"><code class="xref py py-func docutils literal"><span class="pre">periodicBoundariesXY()</span></code></a> and
<a class="reference internal" href="#sphere.sim.periodicBoundariesX" title="sphere.sim.periodicBoundariesX"><code class="xref py py-func docutils literal"><span class="pre">periodicBoundariesX()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.periodicBoundariesX">
<code class="descname">periodicBoundariesX</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.periodicBoundariesX" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the x boundary conditions to be periodic.</p>
<p>See also <a class="reference internal" href="#sphere.sim.normalBoundariesXY" title="sphere.sim.normalBoundariesXY"><code class="xref py py-func docutils literal"><span class="pre">normalBoundariesXY()</span></code></a> and
<a class="reference internal" href="#sphere.sim.periodicBoundariesXY" title="sphere.sim.periodicBoundariesXY"><code class="xref py py-func docutils literal"><span class="pre">periodicBoundariesXY()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.periodicBoundariesXY">
<code class="descname">periodicBoundariesXY</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.periodicBoundariesXY" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the x and y boundary conditions to be periodic.</p>
<p>See also <a class="reference internal" href="#sphere.sim.normalBoundariesXY" title="sphere.sim.normalBoundariesXY"><code class="xref py py-func docutils literal"><span class="pre">normalBoundariesXY()</span></code></a> and
<a class="reference internal" href="#sphere.sim.periodicBoundariesX" title="sphere.sim.periodicBoundariesX"><code class="xref py py-func docutils literal"><span class="pre">periodicBoundariesX()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.plotContacts">
<code class="descname">plotContacts</code><span class="sig-paren">(</span><em>graphics_format='png', figsize=[4, 4], title=None, lower_limit=0.0, upper_limit=1.0, alpha=1.0, return_data=False, outfolder='.', f_min=None, f_max=None, histogram=True, forcechains=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.plotContacts" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot current contact orientations on polar plot</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lower_limit</strong> (<em>float</em>) &#8211; Do not visualize force chains below this relative
contact force magnitude, in ]0;1[</li>
<li><strong>upper_limit</strong> (<em>float</em>) &#8211; Visualize force chains above this relative
contact force magnitude but cap color bar range, in ]0;1[</li>
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.plotConvergence">
<code class="descname">plotConvergence</code><span class="sig-paren">(</span><em>graphics_format='png'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.plotConvergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the convergence evolution in the CFD solver. The plot is saved
in the output folder with the file name
&#8216;&lt;simulation id&gt;-conv.&lt;graphics_format&gt;&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.convergence" title="sphere.sim.convergence"><code class="xref py py-func docutils literal"><span class="pre">convergence()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.plotFluidDiffAdvPresZ">
<code class="descname">plotFluidDiffAdvPresZ</code><span class="sig-paren">(</span><em>graphics_format='png'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.plotFluidDiffAdvPresZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare contributions to the velocity from diffusion and advection,
assuming the flow is 1D along the z-axis, phi = 1, and dphi = 0. This
solution is analog to the predicted velocity and not constrained by the
conservation of mass. The plot is saved in the output folder with the
name format &#8216;&lt;simulation id&gt;-diff_adv-t=&lt;current time&gt;s-mu=&lt;dynamic
viscosity&gt;Pa-s.&lt;graphics_format&gt;&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.plotFluidPressuresY">
<code class="descname">plotFluidPressuresY</code><span class="sig-paren">(</span><em>y=-1</em>, <em>graphics_format='png'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.plotFluidPressuresY" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot fluid pressures in a plane normal to the second axis.
The plot is saved in the current folder with the format
&#8216;p_f-&lt;simulation id&gt;-y&lt;y value&gt;.&lt;graphics_format&gt;&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>y</strong> (<em>int</em>) &#8211; Plot pressures in fluid cells with these y axis values. If
this value is -1, the center y position is used.</li>
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.writeFluidVTK" title="sphere.sim.writeFluidVTK"><code class="xref py py-func docutils literal"><span class="pre">writeFluidVTK()</span></code></a> and <a class="reference internal" href="#sphere.sim.plotFluidPressuresZ" title="sphere.sim.plotFluidPressuresZ"><code class="xref py py-func docutils literal"><span class="pre">plotFluidPressuresZ()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.plotFluidPressuresZ">
<code class="descname">plotFluidPressuresZ</code><span class="sig-paren">(</span><em>z=-1</em>, <em>graphics_format='png'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.plotFluidPressuresZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot fluid pressures in a plane normal to the third axis.
The plot is saved in the current folder with the format
&#8216;p_f-&lt;simulation id&gt;-z&lt;z value&gt;.&lt;graphics_format&gt;&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>int</em>) &#8211; Plot pressures in fluid cells with these z axis values. If
this value is -1, the center z position is used.</li>
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.writeFluidVTK" title="sphere.sim.writeFluidVTK"><code class="xref py py-func docutils literal"><span class="pre">writeFluidVTK()</span></code></a> and <a class="reference internal" href="#sphere.sim.plotFluidPressuresY" title="sphere.sim.plotFluidPressuresY"><code class="xref py py-func docutils literal"><span class="pre">plotFluidPressuresY()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.plotFluidVelocitiesY">
<code class="descname">plotFluidVelocitiesY</code><span class="sig-paren">(</span><em>y=-1</em>, <em>graphics_format='png'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.plotFluidVelocitiesY" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot fluid velocities in a plane normal to the second axis.
The plot is saved in the current folder with the format
&#8216;v_f-&lt;simulation id&gt;-z&lt;z value&gt;.&lt;graphics_format&gt;&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>y</strong> (<em>int</em>) &#8211; Plot velocities in fluid cells with these y axis values. If
this value is -1, the center y position is used.</li>
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.writeFluidVTK" title="sphere.sim.writeFluidVTK"><code class="xref py py-func docutils literal"><span class="pre">writeFluidVTK()</span></code></a> and <a class="reference internal" href="#sphere.sim.plotFluidVelocitiesZ" title="sphere.sim.plotFluidVelocitiesZ"><code class="xref py py-func docutils literal"><span class="pre">plotFluidVelocitiesZ()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.plotFluidVelocitiesZ">
<code class="descname">plotFluidVelocitiesZ</code><span class="sig-paren">(</span><em>z=-1</em>, <em>graphics_format='png'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.plotFluidVelocitiesZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot fluid velocities in a plane normal to the third axis.
The plot is saved in the current folder with the format
&#8216;v_f-&lt;simulation id&gt;-z&lt;z value&gt;.&lt;graphics_format&gt;&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>int</em>) &#8211; Plot velocities in fluid cells with these z axis values. If
this value is -1, the center z position is used.</li>
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.writeFluidVTK" title="sphere.sim.writeFluidVTK"><code class="xref py py-func docutils literal"><span class="pre">writeFluidVTK()</span></code></a> and <a class="reference internal" href="#sphere.sim.plotFluidVelocitiesY" title="sphere.sim.plotFluidVelocitiesY"><code class="xref py py-func docutils literal"><span class="pre">plotFluidVelocitiesY()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.plotLoadCurve">
<code class="descname">plotLoadCurve</code><span class="sig-paren">(</span><em>graphics_format='png'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.plotLoadCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the load curve (log time vs. upper wall movement).  The plot is
saved in the current folder with the file name
&#8216;&lt;simulation id&gt;-loadcurve.&lt;graphics_format&gt;&#8217;.
The consolidation coefficient calculations are done on the base of
Bowles 1992, p. 129&#8211;139, using the &#8220;Casagrande&#8221; method.
It is assumed that the consolidation has stopped at the end of the
simulation (i.e. flat curve).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.plotPrescribedFluidPressures">
<code class="descname">plotPrescribedFluidPressures</code><span class="sig-paren">(</span><em>graphics_format='png'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.plotPrescribedFluidPressures" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the prescribed fluid pressures through time that may be
modulated through the class parameters p_mod_A, p_mod_f, and p_mod_phi.
The plot is saved in the output folder with the file name
&#8216;&lt;simulation id&gt;-pres.&lt;graphics_format&gt;&#8217;.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.plotSinFunction">
<code class="descname">plotSinFunction</code><span class="sig-paren">(</span><em>baseval</em>, <em>A</em>, <em>f</em>, <em>phi=0.0</em>, <em>xlabel='$t$ [s]'</em>, <em>ylabel='$y$'</em>, <em>plotstyle='.'</em>, <em>outformat='png'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.plotSinFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the values of a sinusoidal modulated base value. Saves the output
as a plot in the current folder.
The time values will range from <cite>self.time_current</cite> to
<cite>self.time_total</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>baseval</strong> (<em>float</em>) &#8211; The center value which the sinusoidal fluctuations are
modulating</li>
<li><strong>A</strong> (<em>float</em>) &#8211; The fluctuation amplitude</li>
<li><strong>phi</strong> (<em>float</em>) &#8211; The phase shift [s]</li>
<li><strong>xlabel</strong> (<em>str</em>) &#8211; The label for the x axis</li>
<li><strong>ylabel</strong> (<em>str</em>) &#8211; The label for the y axis</li>
<li><strong>plotstyle</strong> (<em>str</em>) &#8211; Matplotlib-string for specifying plotting style</li>
<li><strong>outformat</strong> (<em>str</em>) &#8211; File format of the output plot</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.porosities">
<code class="descname">porosities</code><span class="sig-paren">(</span><em>graphics_format='pdf'</em>, <em>zslices=16</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.porosities" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the averaged porosities with depth. The plot is saved in the format
&#8216;&lt;simulation id&gt;-porosity.&lt;graphics_format&gt;&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</li>
<li><strong>zslices</strong> (<em>int</em>) &#8211; The number of points along the vertical axis to sample
the porosity in</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.porosity">
<code class="descname">porosity</code><span class="sig-paren">(</span><em>slices=10</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.porosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the porosity as a function of depth, by averaging values in
horizontal slabs. Returns porosity values and their corresponding depth.
The values are calculated using the external <code class="docutils literal"><span class="pre">porosity</span></code> program.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>slices</strong> (<em>int</em>) &#8211; The number of vertical slabs to find porosities in.</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show the file name of the temporary file written to
disk</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A 2d array of depths and their averaged porosities</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.randomBondPairs">
<code class="descname">randomBondPairs</code><span class="sig-paren">(</span><em>ratio=0.3</em>, <em>spacing=-0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.randomBondPairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bond an amount of particles in two-particle clusters. The particles
should be initialized beforehand.  Note: The actual number of bonds is
likely to be somewhat smaller than specified, due to the random
selection algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ratio</strong> (<em>float</em>) &#8211; The amount of particles to bond, values in ]0.0;1.0]</li>
<li><strong>spacing</strong> (<em>float</em>) &#8211; The distance relative to the sum of radii between bonded
particles, neg. values denote an overlap. Values in ]0.0,inf[.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.readTime">
<code class="descname">readTime</code><span class="sig-paren">(</span><em>time</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.readTime" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the output file most closely corresponding to the time given as an
argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>float</em>) &#8211; The desired current time [s]</td>
</tr>
</tbody>
</table>
<p>See also <a class="reference internal" href="#sphere.sim.readbin" title="sphere.sim.readbin"><code class="xref py py-func docutils literal"><span class="pre">readbin()</span></code></a>, <a class="reference internal" href="#sphere.sim.readfirst" title="sphere.sim.readfirst"><code class="xref py py-func docutils literal"><span class="pre">readfirst()</span></code></a>, <a class="reference internal" href="#sphere.sim.readsecond" title="sphere.sim.readsecond"><code class="xref py py-func docutils literal"><span class="pre">readsecond()</span></code></a>, and
<a class="reference internal" href="#sphere.sim.readstep" title="sphere.sim.readstep"><code class="xref py py-func docutils literal"><span class="pre">readstep()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.readbin">
<code class="descname">readbin</code><span class="sig-paren">(</span><em>targetbin</em>, <em>verbose=True</em>, <em>bonds=True</em>, <em>sigma0mod=True</em>, <em>esysparticle=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.readbin" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a target <code class="docutils literal"><span class="pre">sphere</span></code> binary file.</p>
<p>See also <a class="reference internal" href="#sphere.sim.writebin" title="sphere.sim.writebin"><code class="xref py py-func docutils literal"><span class="pre">writebin()</span></code></a>, <a class="reference internal" href="#sphere.sim.readfirst" title="sphere.sim.readfirst"><code class="xref py py-func docutils literal"><span class="pre">readfirst()</span></code></a>, <a class="reference internal" href="#sphere.sim.readlast" title="sphere.sim.readlast"><code class="xref py py-func docutils literal"><span class="pre">readlast()</span></code></a>,
<a class="reference internal" href="#sphere.sim.readsecond" title="sphere.sim.readsecond"><code class="xref py py-func docutils literal"><span class="pre">readsecond()</span></code></a>, and <a class="reference internal" href="#sphere.sim.readstep" title="sphere.sim.readstep"><code class="xref py py-func docutils literal"><span class="pre">readstep()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>targetbin</strong> (<em>str</em>) &#8211; The path to the binary <code class="docutils literal"><span class="pre">sphere</span></code> file</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show diagnostic information (default = True)</li>
<li><strong>bonds</strong> (<em>bool</em>) &#8211; The input file contains bond information (default = True).
This parameter should be true for all recent <code class="docutils literal"><span class="pre">sphere</span></code> versions.</li>
<li><strong>sigma0mod</strong> (<em>bool</em>) &#8211; The input file contains information about modulating
stresses at the top wall (default = True). This parameter should be
true for all recent <code class="docutils literal"><span class="pre">sphere</span></code> versions.</li>
<li><strong>esysparticle</strong> (<em>bool</em>) &#8211; Stop reading the file after reading the kinematics,
which is useful for reading output files from other DEM programs.
(default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.readfirst">
<code class="descname">readfirst</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.readfirst" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the first output file from the <code class="docutils literal"><span class="pre">../output/</span></code> folder, corresponding
to the object simulation id (<code class="docutils literal"><span class="pre">self.sid</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>bool</em>) &#8211; Display diagnostic information (default = True)</td>
</tr>
</tbody>
</table>
<p>See also <a class="reference internal" href="#sphere.sim.readbin" title="sphere.sim.readbin"><code class="xref py py-func docutils literal"><span class="pre">readbin()</span></code></a>, <a class="reference internal" href="#sphere.sim.readlast" title="sphere.sim.readlast"><code class="xref py py-func docutils literal"><span class="pre">readlast()</span></code></a>, <a class="reference internal" href="#sphere.sim.readsecond" title="sphere.sim.readsecond"><code class="xref py py-func docutils literal"><span class="pre">readsecond()</span></code></a>, and
<a class="reference internal" href="#sphere.sim.readstep" title="sphere.sim.readstep"><code class="xref py py-func docutils literal"><span class="pre">readstep()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.readlast">
<code class="descname">readlast</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.readlast" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the last output file from the <code class="docutils literal"><span class="pre">../output/</span></code> folder, corresponding
to the object simulation id (<code class="docutils literal"><span class="pre">self.sid</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>bool</em>) &#8211; Display diagnostic information (default = True)</td>
</tr>
</tbody>
</table>
<p>See also <a class="reference internal" href="#sphere.sim.readbin" title="sphere.sim.readbin"><code class="xref py py-func docutils literal"><span class="pre">readbin()</span></code></a>, <a class="reference internal" href="#sphere.sim.readfirst" title="sphere.sim.readfirst"><code class="xref py py-func docutils literal"><span class="pre">readfirst()</span></code></a>, <a class="reference internal" href="#sphere.sim.readsecond" title="sphere.sim.readsecond"><code class="xref py py-func docutils literal"><span class="pre">readsecond()</span></code></a>, and
<a class="reference internal" href="#sphere.sim.readstep" title="sphere.sim.readstep"><code class="xref py py-func docutils literal"><span class="pre">readstep()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.readsecond">
<code class="descname">readsecond</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.readsecond" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the second output file from the <code class="docutils literal"><span class="pre">../output/</span></code> folder,
corresponding to the object simulation id (<code class="docutils literal"><span class="pre">self.sid</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>bool</em>) &#8211; Display diagnostic information (default = True)</td>
</tr>
</tbody>
</table>
<p>See also <a class="reference internal" href="#sphere.sim.readbin" title="sphere.sim.readbin"><code class="xref py py-func docutils literal"><span class="pre">readbin()</span></code></a>, <a class="reference internal" href="#sphere.sim.readfirst" title="sphere.sim.readfirst"><code class="xref py py-func docutils literal"><span class="pre">readfirst()</span></code></a>, <a class="reference internal" href="#sphere.sim.readlast" title="sphere.sim.readlast"><code class="xref py py-func docutils literal"><span class="pre">readlast()</span></code></a>,
and <a class="reference internal" href="#sphere.sim.readstep" title="sphere.sim.readstep"><code class="xref py py-func docutils literal"><span class="pre">readstep()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.readstep">
<code class="descname">readstep</code><span class="sig-paren">(</span><em>step</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.readstep" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a output file from the <code class="docutils literal"><span class="pre">../output/</span></code> folder, corresponding
to the object simulation id (<code class="docutils literal"><span class="pre">self.sid</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>step</strong> (<em>int</em>) &#8211; The output file number to read, starting from 0.</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Display diagnostic information (default = True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also <a class="reference internal" href="#sphere.sim.readbin" title="sphere.sim.readbin"><code class="xref py py-func docutils literal"><span class="pre">readbin()</span></code></a>, <a class="reference internal" href="#sphere.sim.readfirst" title="sphere.sim.readfirst"><code class="xref py py-func docutils literal"><span class="pre">readfirst()</span></code></a>, <a class="reference internal" href="#sphere.sim.readlast" title="sphere.sim.readlast"><code class="xref py py-func docutils literal"><span class="pre">readlast()</span></code></a>,
and <a class="reference internal" href="#sphere.sim.readsecond" title="sphere.sim.readsecond"><code class="xref py py-func docutils literal"><span class="pre">readsecond()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.render">
<code class="descname">render</code><span class="sig-paren">(</span><em>method='pres'</em>, <em>max_val=1000.0</em>, <em>lower_cutoff=0.0</em>, <em>graphics_format='png'</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the built-in ray tracer, render all output files that belong to
the simulation, determined by the simulation id (<code class="docutils literal"><span class="pre">sid</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method</strong> (<em>str</em>) &#8211; The color visualization method to use for the particles.
Possible values are: &#8216;normal&#8217;: color all particles with the same
color, &#8216;pres&#8217;: color by pressure, &#8216;vel&#8217;: color by translational
velocity, &#8216;angvel&#8217;: color by rotational velocity, &#8216;xdisp&#8217;: color by
total displacement along the x-axis, &#8216;angpos&#8217;: color by angular
position.</li>
<li><strong>max_val</strong> (<em>float</em>) &#8211; The maximum value of the color bar</li>
<li><strong>lower_cutoff</strong> (<em>float</em>) &#8211; Do not render particles with a value below this
value, of the field selected by <code class="docutils literal"><span class="pre">method</span></code></li>
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; Convert the PPM images generated by the ray
tracer to this image format using Imagemagick</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show verbose information during ray tracing</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.rotationalEnergy">
<code class="descname">rotationalEnergy</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.rotationalEnergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the rotational energy for a particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int</em>) &#8211; Particle index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The rotational kinetic energy of the particle [J]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>verbose=True</em>, <em>hideinputfile=False</em>, <em>dry=False</em>, <em>valgrind=False</em>, <em>cudamemcheck=False</em>, <em>device=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Start <code class="docutils literal"><span class="pre">sphere</span></code> calculations on the <code class="docutils literal"><span class="pre">sim</span></code> object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show <code class="docutils literal"><span class="pre">sphere</span></code> output</li>
<li><strong>hideinputfile</strong> (<em>bool</em>) &#8211; Hide the file name of the <code class="docutils literal"><span class="pre">sphere</span></code> input file</li>
<li><strong>dry</strong> (<em>bool</em>) &#8211; Perform a dry run. Important parameter values are shown by
the <code class="docutils literal"><span class="pre">sphere</span></code> program, and it exits afterwards.</li>
<li><strong>valgrind</strong> (<em>bool</em>) &#8211; Run the program with <code class="docutils literal"><span class="pre">valgrind</span></code> in order to check
memory leaks in the host code. This causes a significant increase in
computational time.</li>
<li><strong>cudamemcheck</strong> (<em>bool</em>) &#8211; Run the program with <code class="docutils literal"><span class="pre">cudamemcheck</span></code> in order to
check for device memory leaks and errors. This causes a significant
increase in computational time.</li>
<li><strong>device</strong> (<em>int</em>) &#8211; Specify the GPU device to execute the program on.
If not specified, sphere will use the device with the most CUDA cores.
To see a list of devices, run <code class="docutils literal"><span class="pre">nvidia-smi</span></code> in the system shell.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.scaleSize">
<code class="descname">scaleSize</code><span class="sig-paren">(</span><em>factor</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.scaleSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the positions, linear velocities, forces, torques and radii of all
particles and mobile walls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>factor</strong> (<em>float</em>) &#8211; Spatial scaling factor ]0;inf[</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setBeta">
<code class="descname">setBeta</code><span class="sig-paren">(</span><em>beta</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setBeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Beta is a fluid solver parameter, used in velocity prediction and
pressure iteration 1.0: Use old pressures for fluid velocity prediction
(see Langtangen et al. 2002) 0.0: Do not use old pressures for fluid
velocity prediction (Chorin&#8217;s original projection method, see Chorin
(1968) and &#8220;Projection method (fluid dynamics)&#8221; page on Wikipedia.  The
best results precision and performance-wise are obtained by using a beta
of 0 and a low tolerance criteria value.</p>
<p>The default and recommended value is 0.0.</p>
<p>Other solver parameter setting functions: <a class="reference internal" href="#sphere.sim.setGamma" title="sphere.sim.setGamma"><code class="xref py py-func docutils literal"><span class="pre">setGamma()</span></code></a>,
<a class="reference internal" href="#sphere.sim.setTheta" title="sphere.sim.setTheta"><code class="xref py py-func docutils literal"><span class="pre">setTheta()</span></code></a>, <a class="reference internal" href="#sphere.sim.setTolerance" title="sphere.sim.setTolerance"><code class="xref py py-func docutils literal"><span class="pre">setTolerance()</span></code></a>,
<a class="reference internal" href="#sphere.sim.setDEMstepsPerCFDstep" title="sphere.sim.setDEMstepsPerCFDstep"><code class="xref py py-func docutils literal"><span class="pre">setDEMstepsPerCFDstep()</span></code></a> and
<a class="reference internal" href="#sphere.sim.setMaxIterations" title="sphere.sim.setMaxIterations"><code class="xref py py-func docutils literal"><span class="pre">setMaxIterations()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setDEMstepsPerCFDstep">
<code class="descname">setDEMstepsPerCFDstep</code><span class="sig-paren">(</span><em>ndem</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setDEMstepsPerCFDstep" title="Permalink to this definition">¶</a></dt>
<dd><p>A fluid solver parameter, the value of the maxiter parameter denotes the
number of DEM time steps to be performed per CFD time step.</p>
<p>The default value is 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ndem</strong> (<em>int</em>) &#8211; The DEM/CFD time step ratio</td>
</tr>
</tbody>
</table>
<p>Other solver parameter setting functions: <a class="reference internal" href="#sphere.sim.setGamma" title="sphere.sim.setGamma"><code class="xref py py-func docutils literal"><span class="pre">setGamma()</span></code></a>,
<a class="reference internal" href="#sphere.sim.setTheta" title="sphere.sim.setTheta"><code class="xref py py-func docutils literal"><span class="pre">setTheta()</span></code></a>, <a class="reference internal" href="#sphere.sim.setBeta" title="sphere.sim.setBeta"><code class="xref py py-func docutils literal"><span class="pre">setBeta()</span></code></a>, <a class="reference internal" href="#sphere.sim.setTolerance" title="sphere.sim.setTolerance"><code class="xref py py-func docutils literal"><span class="pre">setTolerance()</span></code></a> and
<a class="reference internal" href="#sphere.sim.setMaxIterations" title="sphere.sim.setMaxIterations"><code class="xref py py-func docutils literal"><span class="pre">setMaxIterations()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setDampingNormal">
<code class="descname">setDampingNormal</code><span class="sig-paren">(</span><em>gamma</em>, <em>over_damping=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setDampingNormal" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the dampening coefficient (gamma) in the normal direction of the
particle-particle contact model. The function will print the fraction
between the chosen damping and the critical damping value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>gamma</strong> (<em>float</em>) &#8211; The viscous damping constant [N/(m/s)]</li>
<li><strong>over_damping</strong> (<em>boolean</em>) &#8211; Accept overdampening</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also: <code class="xref py py-func docutils literal"><span class="pre">setDampingTangential(gamma)()</span></code></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setDampingTangential">
<code class="descname">setDampingTangential</code><span class="sig-paren">(</span><em>gamma</em>, <em>over_damping=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setDampingTangential" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the dampening coefficient (gamma) in the tangential direction of the
particle-particle contact model. The function will print the fraction
between the chosen damping and the critical damping value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>gamma</strong> (<em>float</em>) &#8211; The viscous damping constant [N/(m/s)]</li>
<li><strong>over_damping</strong> (<em>boolean</em>) &#8211; Accept overdampening</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also: <code class="xref py py-func docutils literal"><span class="pre">setDampingNormal(gamma)()</span></code></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setDynamicFriction">
<code class="descname">setDynamicFriction</code><span class="sig-paren">(</span><em>mu_d</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setDynamicFriction" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the dynamic friction coefficient for particle-particle interactions
(<cite>self.mu_d</cite>). This value describes the resistance to a shearing motion
while it is happening (contact tangential velocity larger than 0).
Strain softening can be introduced by having a smaller dynamic
frictional coefficient than the static fricion coefficient. Usually this
value is identical to the static friction coefficient.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mu_d</strong> (<em>float</em>) &#8211; Value of the dynamic friction coefficient, in [0;inf[.
Usually between 0 and 1.</td>
</tr>
</tbody>
</table>
<p>See also: <code class="xref py py-func docutils literal"><span class="pre">setStaticFriction(mu_s)()</span></code></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidBottomFixedFlux">
<code class="descname">setFluidBottomFixedFlux</code><span class="sig-paren">(</span><em>specific_flux</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidBottomFixedFlux" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a constant fluid flux normal to the boundary.</p>
<p>The default behavior for the boundary is fixed value (Dirichlet), see
<a class="reference internal" href="#sphere.sim.setFluidBottomFixedPressure" title="sphere.sim.setFluidBottomFixedPressure"><code class="xref py py-func docutils literal"><span class="pre">setFluidBottomFixedPressure()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>specific_flux</strong> &#8211; Specific flux values across boundary (positive
values upwards), [m/s]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidBottomFixedPressure">
<code class="descname">setFluidBottomFixedPressure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidBottomFixedPressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the lower boundary of the fluid domain to follow the fixed pressure
value (Dirichlet) boundary condition.</p>
<p>This is the default behavior for the boundary. See also
<a class="reference internal" href="#sphere.sim.setFluidBottomNoFlow" title="sphere.sim.setFluidBottomNoFlow"><code class="xref py py-func docutils literal"><span class="pre">setFluidBottomNoFlow()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidBottomNoFlow">
<code class="descname">setFluidBottomNoFlow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidBottomNoFlow" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the lower boundary of the fluid domain to follow the no-flow
(Neumann) boundary condition with free slip parallel to the boundary.</p>
<p>The default behavior for the boundary is fixed value (Dirichlet), see
<a class="reference internal" href="#sphere.sim.setFluidBottomFixedPressure" title="sphere.sim.setFluidBottomFixedPressure"><code class="xref py py-func docutils literal"><span class="pre">setFluidBottomFixedPressure()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidBottomNoFlowNoSlip">
<code class="descname">setFluidBottomNoFlowNoSlip</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidBottomNoFlowNoSlip" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the lower boundary of the fluid domain to follow the no-flow
(Neumann) boundary condition with no slip parallel to the boundary.</p>
<p>The default behavior for the boundary is fixed value (Dirichlet), see
<a class="reference internal" href="#sphere.sim.setFluidBottomFixedPressure" title="sphere.sim.setFluidBottomFixedPressure"><code class="xref py py-func docutils literal"><span class="pre">setFluidBottomFixedPressure()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidCompressibility">
<code class="descname">setFluidCompressibility</code><span class="sig-paren">(</span><em>beta_f</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidCompressibility" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the fluid adiabatic compressibility [1/Pa]. This value is equal to
<cite>1/K</cite> where <cite>K</cite> is the bulk modulus [Pa]. The value for water is 5.1e-10
for water at 0 degrees Celcius. This parameter is used for the Darcy
solver exclusively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>beta_f</strong> (<em>float</em>) &#8211; The fluid compressibility [1/Pa]</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.setFluidDensity" title="sphere.sim.setFluidDensity"><code class="xref py py-func docutils literal"><span class="pre">setFluidDensity()</span></code></a> and <a class="reference internal" href="#sphere.sim.setFluidViscosity" title="sphere.sim.setFluidViscosity"><code class="xref py py-func docutils literal"><span class="pre">setFluidViscosity()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidDensity">
<code class="descname">setFluidDensity</code><span class="sig-paren">(</span><em>rho_f</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidDensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the fluid density [kg/(m*m*m)]. The value for water is 1000. This
parameter is used for the Navier-Stokes fluid solver exclusively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rho_f</strong> (<em>float</em>) &#8211; The fluid density [kg/(m*m*m)]</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>See also: <a class="reference internal" href="#sphere.sim.setFluidViscosity" title="sphere.sim.setFluidViscosity"><code class="xref py py-func docutils literal"><span class="pre">setFluidViscosity()</span></code></a> and</dt>
<dd><a class="reference internal" href="#sphere.sim.setFluidCompressibility" title="sphere.sim.setFluidCompressibility"><code class="xref py py-func docutils literal"><span class="pre">setFluidCompressibility()</span></code></a></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidPressureModulation">
<code class="descname">setFluidPressureModulation</code><span class="sig-paren">(</span><em>A</em>, <em>f</em>, <em>phi=0.0</em>, <em>plot=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidPressureModulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters for the sine wave modulating the fluid pressures
at the top boundary. Note that a cos-wave is obtained with phi=pi/2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>A</strong> (<em>float</em>) &#8211; Fluctuation amplitude [Pa]</li>
<li><strong>f</strong> (<em>float</em>) &#8211; Fluctuation frequency [Hz]</li>
<li><strong>phi</strong> (<em>float</em>) &#8211; Fluctuation phase shift (default=0.0) [rad]</li>
<li><strong>plot</strong> (<em>bool</em>) &#8211; Show a plot of the resulting modulation</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.setTopWallNormalStressModulation" title="sphere.sim.setTopWallNormalStressModulation"><code class="xref py py-func docutils literal"><span class="pre">setTopWallNormalStressModulation()</span></code></a> and
<a class="reference internal" href="#sphere.sim.disableFluidPressureModulation" title="sphere.sim.disableFluidPressureModulation"><code class="xref py py-func docutils literal"><span class="pre">disableFluidPressureModulation()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidTopFixedFlux">
<code class="descname">setFluidTopFixedFlux</code><span class="sig-paren">(</span><em>specific_flux</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidTopFixedFlux" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a constant fluid flux normal to the boundary.</p>
<p>The default behavior for the boundary is fixed value (Dirichlet), see
<a class="reference internal" href="#sphere.sim.setFluidBottomFixedPressure" title="sphere.sim.setFluidBottomFixedPressure"><code class="xref py py-func docutils literal"><span class="pre">setFluidBottomFixedPressure()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>specific_flux</strong> &#8211; Specific flux values across boundary (positive
values upwards), [m/s]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidTopFixedPressure">
<code class="descname">setFluidTopFixedPressure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidTopFixedPressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the upper boundary of the fluid domain to follow the fixed pressure
value (Dirichlet) boundary condition.</p>
<p>This is the default behavior for the boundary. See also
<a class="reference internal" href="#sphere.sim.setFluidTopNoFlow" title="sphere.sim.setFluidTopNoFlow"><code class="xref py py-func docutils literal"><span class="pre">setFluidTopNoFlow()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidTopNoFlow">
<code class="descname">setFluidTopNoFlow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidTopNoFlow" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the upper boundary of the fluid domain to follow the no-flow
(Neumann) boundary condition with free slip parallel to the boundary.</p>
<p>The default behavior for the boundary is fixed value (Dirichlet), see
<a class="reference internal" href="#sphere.sim.setFluidTopFixedPressure" title="sphere.sim.setFluidTopFixedPressure"><code class="xref py py-func docutils literal"><span class="pre">setFluidTopFixedPressure()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidTopNoFlowNoSlip">
<code class="descname">setFluidTopNoFlowNoSlip</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidTopNoFlowNoSlip" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the upper boundary of the fluid domain to follow the no-flow
(Neumann) boundary condition with no slip parallel to the boundary.</p>
<p>The default behavior for the boundary is fixed value (Dirichlet), see
<a class="reference internal" href="#sphere.sim.setFluidTopFixedPressure" title="sphere.sim.setFluidTopFixedPressure"><code class="xref py py-func docutils literal"><span class="pre">setFluidTopFixedPressure()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidViscosity">
<code class="descname">setFluidViscosity</code><span class="sig-paren">(</span><em>mu</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidViscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the fluid dynamic viscosity [Pa*s]. The value for water is
1.797e-3 at 0 degrees Celcius. This parameter is used for both the Darcy
and Navier-Stokes fluid solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mu</strong> (<em>float</em>) &#8211; The fluid dynamic viscosity [Pa*s]</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>See also: <a class="reference internal" href="#sphere.sim.setFluidDensity" title="sphere.sim.setFluidDensity"><code class="xref py py-func docutils literal"><span class="pre">setFluidDensity()</span></code></a> and</dt>
<dd><a class="reference internal" href="#sphere.sim.setFluidCompressibility" title="sphere.sim.setFluidCompressibility"><code class="xref py py-func docutils literal"><span class="pre">setFluidCompressibility()</span></code></a></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidXFixedPressure">
<code class="descname">setFluidXFixedPressure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidXFixedPressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the X boundaries of the fluid domain to follow the fixed pressure
value (Dirichlet) boundary condition.</p>
<p>This is not the default behavior for the boundary. See also
<a class="reference internal" href="#sphere.sim.setFluidXFixedPressure" title="sphere.sim.setFluidXFixedPressure"><code class="xref py py-func docutils literal"><span class="pre">setFluidXFixedPressure()</span></code></a>,
<a class="reference internal" href="#sphere.sim.setFluidXNoFlow" title="sphere.sim.setFluidXNoFlow"><code class="xref py py-func docutils literal"><span class="pre">setFluidXNoFlow()</span></code></a>, and
<a class="reference internal" href="#sphere.sim.setFluidXPeriodic" title="sphere.sim.setFluidXPeriodic"><code class="xref py py-func docutils literal"><span class="pre">setFluidXPeriodic()</span></code></a> (default)</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidXNoFlow">
<code class="descname">setFluidXNoFlow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidXNoFlow" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the X boundaries of the fluid domain to follow the no-flow
(Neumann) boundary condition.</p>
<p>This is not the default behavior for the boundary. See also
<a class="reference internal" href="#sphere.sim.setFluidXFixedPressure" title="sphere.sim.setFluidXFixedPressure"><code class="xref py py-func docutils literal"><span class="pre">setFluidXFixedPressure()</span></code></a>,
<a class="reference internal" href="#sphere.sim.setFluidXNoFlow" title="sphere.sim.setFluidXNoFlow"><code class="xref py py-func docutils literal"><span class="pre">setFluidXNoFlow()</span></code></a>, and
<a class="reference internal" href="#sphere.sim.setFluidXPeriodic" title="sphere.sim.setFluidXPeriodic"><code class="xref py py-func docutils literal"><span class="pre">setFluidXPeriodic()</span></code></a> (default)</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidXPeriodic">
<code class="descname">setFluidXPeriodic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidXPeriodic" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the X boundaries of the fluid domain to follow the periodic
(cyclic) boundary condition.</p>
<p>This is the default behavior for the boundary. See also
<a class="reference internal" href="#sphere.sim.setFluidXFixedPressure" title="sphere.sim.setFluidXFixedPressure"><code class="xref py py-func docutils literal"><span class="pre">setFluidXFixedPressure()</span></code></a> and
<a class="reference internal" href="#sphere.sim.setFluidXNoFlow" title="sphere.sim.setFluidXNoFlow"><code class="xref py py-func docutils literal"><span class="pre">setFluidXNoFlow()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidYFixedPressure">
<code class="descname">setFluidYFixedPressure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidYFixedPressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the Y boundaries of the fluid domain to follow the fixed pressure
value (Dirichlet) boundary condition.</p>
<p>This is not the default behavior for the boundary. See also
<a class="reference internal" href="#sphere.sim.setFluidYNoFlow" title="sphere.sim.setFluidYNoFlow"><code class="xref py py-func docutils literal"><span class="pre">setFluidYNoFlow()</span></code></a> and
<a class="reference internal" href="#sphere.sim.setFluidYPeriodic" title="sphere.sim.setFluidYPeriodic"><code class="xref py py-func docutils literal"><span class="pre">setFluidYPeriodic()</span></code></a> (default)</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidYNoFlow">
<code class="descname">setFluidYNoFlow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidYNoFlow" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the Y boundaries of the fluid domain to follow the no-flow
(Neumann) boundary condition.</p>
<p>This is not the default behavior for the boundary. See also
<a class="reference internal" href="#sphere.sim.setFluidYFixedPressure" title="sphere.sim.setFluidYFixedPressure"><code class="xref py py-func docutils literal"><span class="pre">setFluidYFixedPressure()</span></code></a> and
<a class="reference internal" href="#sphere.sim.setFluidYPeriodic" title="sphere.sim.setFluidYPeriodic"><code class="xref py py-func docutils literal"><span class="pre">setFluidYPeriodic()</span></code></a> (default)</p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setFluidYPeriodic">
<code class="descname">setFluidYPeriodic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setFluidYPeriodic" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the Y boundaries of the fluid domain to follow the periodic
(cyclic) boundary condition.</p>
<p>This is the default behavior for the boundary. See also
<a class="reference internal" href="#sphere.sim.setFluidYFixedPressure" title="sphere.sim.setFluidYFixedPressure"><code class="xref py py-func docutils literal"><span class="pre">setFluidYFixedPressure()</span></code></a> and
<a class="reference internal" href="#sphere.sim.setFluidYNoFlow" title="sphere.sim.setFluidYNoFlow"><code class="xref py py-func docutils literal"><span class="pre">setFluidYNoFlow()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setGamma">
<code class="descname">setGamma</code><span class="sig-paren">(</span><em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setGamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Gamma is a fluid solver parameter, used for smoothing the pressure
values. The epsilon (pressure) values are smoothed by including the
average epsilon value of the six closest (face) neighbor cells. This
parameter should be in the range [0.0;1.0[. The higher the value, the
more averaging is introduced. A value of 0.0 disables all averaging.</p>
<p>The default and recommended value is 0.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>theta</strong> (<em>float</em>) &#8211; The smoothing parameter value</td>
</tr>
</tbody>
</table>
<p>Other solver parameter setting functions: <a class="reference internal" href="#sphere.sim.setTheta" title="sphere.sim.setTheta"><code class="xref py py-func docutils literal"><span class="pre">setTheta()</span></code></a>,
<a class="reference internal" href="#sphere.sim.setBeta" title="sphere.sim.setBeta"><code class="xref py py-func docutils literal"><span class="pre">setBeta()</span></code></a>, <a class="reference internal" href="#sphere.sim.setTolerance" title="sphere.sim.setTolerance"><code class="xref py py-func docutils literal"><span class="pre">setTolerance()</span></code></a>,
<a class="reference internal" href="#sphere.sim.setDEMstepsPerCFDstep" title="sphere.sim.setDEMstepsPerCFDstep"><code class="xref py py-func docutils literal"><span class="pre">setDEMstepsPerCFDstep()</span></code></a> and <a class="reference internal" href="#sphere.sim.setMaxIterations" title="sphere.sim.setMaxIterations"><code class="xref py py-func docutils literal"><span class="pre">setMaxIterations()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setMaxIterations">
<code class="descname">setMaxIterations</code><span class="sig-paren">(</span><em>maxiter</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setMaxIterations" title="Permalink to this definition">¶</a></dt>
<dd><p>A fluid solver parameter, the value of the maxiter parameter denotes the
maximal allowed number of fluid solver iterations before ending the
fluid solver loop prematurely. The residual values are at that point not
fulfilling the tolerance criteria. The parameter is included to avoid
infinite hangs.</p>
<p>The default and recommended value is 1e4.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>maxiter</strong> (<em>int</em>) &#8211; The maximum number of Jacobi iterations in the fluid
solver</td>
</tr>
</tbody>
</table>
<p>Other solver parameter setting functions: <a class="reference internal" href="#sphere.sim.setGamma" title="sphere.sim.setGamma"><code class="xref py py-func docutils literal"><span class="pre">setGamma()</span></code></a>,
<a class="reference internal" href="#sphere.sim.setTheta" title="sphere.sim.setTheta"><code class="xref py py-func docutils literal"><span class="pre">setTheta()</span></code></a>, <a class="reference internal" href="#sphere.sim.setBeta" title="sphere.sim.setBeta"><code class="xref py py-func docutils literal"><span class="pre">setBeta()</span></code></a>, <a class="reference internal" href="#sphere.sim.setDEMstepsPerCFDstep" title="sphere.sim.setDEMstepsPerCFDstep"><code class="xref py py-func docutils literal"><span class="pre">setDEMstepsPerCFDstep()</span></code></a>
and <a class="reference internal" href="#sphere.sim.setTolerance" title="sphere.sim.setTolerance"><code class="xref py py-func docutils literal"><span class="pre">setTolerance()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setPermeabilityGrainSize">
<code class="descname">setPermeabilityGrainSize</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setPermeabilityGrainSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the permeability prefactor based on the mean grain size (Damsgaard
et al., 2015, eq. 10).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>bool</em>) &#8211; Print information about the realistic permeabilities
hydraulic conductivities to expect with the chosen permeability
prefactor.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setPermeabilityPrefactor">
<code class="descname">setPermeabilityPrefactor</code><span class="sig-paren">(</span><em>k_c</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setPermeabilityPrefactor" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the permeability prefactor from Goren et al 2011, eq. 24. The
function will print the limits of permeabilities to be simulated. This
parameter is only used in the Darcy solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>k_c</strong> (<em>float</em>) &#8211; Permeability prefactor value [m*m]</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Print information about the realistic permeabilities and
hydraulic conductivities to expect with the chosen permeability
prefactor.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setStaticFriction">
<code class="descname">setStaticFriction</code><span class="sig-paren">(</span><em>mu_s</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setStaticFriction" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the static friction coefficient for particle-particle interactions
(<cite>self.mu_s</cite>). This value describes the resistance to a shearing motion
while it is not happenind (contact tangential velocity zero).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mu_s</strong> (<em>float</em>) &#8211; Value of the static friction coefficient, in [0;inf[.
Usually between 0 and 1.</td>
</tr>
</tbody>
</table>
<p>See also: <code class="xref py py-func docutils literal"><span class="pre">setDynamicFriction(mu_d)()</span></code></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setStiffnessNormal">
<code class="descname">setStiffnessNormal</code><span class="sig-paren">(</span><em>k_n</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setStiffnessNormal" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the elastic stiffness (<cite>k_n</cite>) in the normal direction of the
contact.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>k_n</strong> (<em>float</em>) &#8211; The elastic stiffness coefficient [N/m]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setStiffnessTangential">
<code class="descname">setStiffnessTangential</code><span class="sig-paren">(</span><em>k_t</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setStiffnessTangential" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the elastic stiffness (<cite>k_t</cite>) in the tangential direction of the
contact.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>k_t</strong> (<em>float</em>) &#8211; The elastic stiffness coefficient [N/m]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setTheta">
<code class="descname">setTheta</code><span class="sig-paren">(</span><em>theta</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setTheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Theta is a fluid solver under-relaxation parameter, used in solution of
Poisson equation. The value should be within the range ]0.0;1.0]. At a
value of 1.0, the new estimate of epsilon values is used exclusively. At
lower values, a linear interpolation between new and old values is used.
The solution typically converges faster with a value of 1.0, but
instabilities may be avoided with lower values.</p>
<p>The default and recommended value is 1.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>theta</strong> (<em>float</em>) &#8211; The under-relaxation parameter value</td>
</tr>
</tbody>
</table>
<p>Other solver parameter setting functions: <a class="reference internal" href="#sphere.sim.setGamma" title="sphere.sim.setGamma"><code class="xref py py-func docutils literal"><span class="pre">setGamma()</span></code></a>,
<a class="reference internal" href="#sphere.sim.setBeta" title="sphere.sim.setBeta"><code class="xref py py-func docutils literal"><span class="pre">setBeta()</span></code></a>, <a class="reference internal" href="#sphere.sim.setTolerance" title="sphere.sim.setTolerance"><code class="xref py py-func docutils literal"><span class="pre">setTolerance()</span></code></a>,
<a class="reference internal" href="#sphere.sim.setDEMstepsPerCFDstep" title="sphere.sim.setDEMstepsPerCFDstep"><code class="xref py py-func docutils literal"><span class="pre">setDEMstepsPerCFDstep()</span></code></a> and <a class="reference internal" href="#sphere.sim.setMaxIterations" title="sphere.sim.setMaxIterations"><code class="xref py py-func docutils literal"><span class="pre">setMaxIterations()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setTolerance">
<code class="descname">setTolerance</code><span class="sig-paren">(</span><em>tolerance</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setTolerance" title="Permalink to this definition">¶</a></dt>
<dd><p>A fluid solver parameter, the value of the tolerance parameter denotes
the required value of the maximum normalized residual for the fluid
solver.</p>
<p>The default and recommended value is 1.0e-3.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tolerance</strong> (<em>float</em>) &#8211; The tolerance criteria for the maximal normalized
residual</td>
</tr>
</tbody>
</table>
<p>Other solver parameter setting functions: <a class="reference internal" href="#sphere.sim.setGamma" title="sphere.sim.setGamma"><code class="xref py py-func docutils literal"><span class="pre">setGamma()</span></code></a>,
<a class="reference internal" href="#sphere.sim.setTheta" title="sphere.sim.setTheta"><code class="xref py py-func docutils literal"><span class="pre">setTheta()</span></code></a>, <a class="reference internal" href="#sphere.sim.setBeta" title="sphere.sim.setBeta"><code class="xref py py-func docutils literal"><span class="pre">setBeta()</span></code></a>, <a class="reference internal" href="#sphere.sim.setDEMstepsPerCFDstep" title="sphere.sim.setDEMstepsPerCFDstep"><code class="xref py py-func docutils literal"><span class="pre">setDEMstepsPerCFDstep()</span></code></a> and
<a class="reference internal" href="#sphere.sim.setMaxIterations" title="sphere.sim.setMaxIterations"><code class="xref py py-func docutils literal"><span class="pre">setMaxIterations()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setTopWallNormalStressModulation">
<code class="descname">setTopWallNormalStressModulation</code><span class="sig-paren">(</span><em>A</em>, <em>f</em>, <em>plot=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setTopWallNormalStressModulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters for the sine wave modulating the normal stress
at the top wall. Note that a cos-wave is obtained with phi=pi/2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>A</strong> (<em>float</em>) &#8211; Fluctuation amplitude [Pa]</li>
<li><strong>f</strong> (<em>float</em>) &#8211; Fluctuation frequency [Hz]</li>
<li><strong>plot</strong> (<em>bool</em>) &#8211; Show a plot of the resulting modulation</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.setFluidPressureModulation" title="sphere.sim.setFluidPressureModulation"><code class="xref py py-func docutils literal"><span class="pre">setFluidPressureModulation()</span></code></a> and
<a class="reference internal" href="#sphere.sim.disableTopWallNormalStressModulation" title="sphere.sim.disableTopWallNormalStressModulation"><code class="xref py py-func docutils literal"><span class="pre">disableTopWallNormalStressModulation()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.setYoungsModulus">
<code class="descname">setYoungsModulus</code><span class="sig-paren">(</span><em>E</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.setYoungsModulus" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the elastic Young&#8217;s modulus (<cite>E</cite>) for the contact model.  This
parameter is used over normal stiffness (<cite>k_n</cite>) and tangential
stiffness (<cite>k_t</cite>) when its value is greater than zero. Using this
parameter produces size-invariant behavior.</p>
<p>Example values are ~70e9 Pa for quartz,
<a class="reference external" href="http://www.engineeringtoolbox.com/young-modulus-d_417.html">http://www.engineeringtoolbox.com/young-modulus-d_417.html</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>E</strong> (<em>float</em>) &#8211; The elastic modulus [Pa]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.shear">
<code class="descname">shear</code><span class="sig-paren">(</span><em>shear_strain_rate=1.0</em>, <em>shear_stress=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.shear" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup shear experiment either by a constant shear rate or a constant
shear stress.  The shear strain rate is the shear velocity divided by
the initial height per second. The shear movement is along the positive
x axis. The function zeroes the tangential wall viscosity (gamma_wt) and
the wall friction coefficients (mu_ws, mu_wn).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>shear_strain_rate</strong> (<em>float</em>) &#8211; The shear strain rate [-] to use if
shear_stress isn&#8217;t False.</li>
<li><strong>shear_stress</strong> (<em>float or bool</em>) &#8211; The shear stress value to use [Pa].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.shearDisplacement">
<code class="descname">shearDisplacement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.shearDisplacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates and returns the current shear displacement. The displacement
is found by determining the total x-axis displacement of the upper,
fixed particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The total shear displacement [m]</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.shearStrain" title="sphere.sim.shearStrain"><code class="xref py py-func docutils literal"><span class="pre">shearStrain()</span></code></a> and <a class="reference internal" href="#sphere.sim.shearVelocity" title="sphere.sim.shearVelocity"><code class="xref py py-func docutils literal"><span class="pre">shearVelocity()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.shearStrain">
<code class="descname">shearStrain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.shearStrain" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates and returns the current shear strain (gamma) value of the
experiment. The shear strain is found by determining the total x-axis
displacement of the upper, fixed particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The total shear strain [-]</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.shearStrainRate" title="sphere.sim.shearStrainRate"><code class="xref py py-func docutils literal"><span class="pre">shearStrainRate()</span></code></a> and <a class="reference internal" href="#sphere.sim.shearVel" title="sphere.sim.shearVel"><code class="xref py py-func docutils literal"><span class="pre">shearVel()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.shearStrainRate">
<code class="descname">shearStrainRate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.shearStrainRate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the shear strain rate (dot(gamma)) value of the experiment.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The value of dot(gamma)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.shearStrain" title="sphere.sim.shearStrain"><code class="xref py py-func docutils literal"><span class="pre">shearStrain()</span></code></a> and <a class="reference internal" href="#sphere.sim.shearVel" title="sphere.sim.shearVel"><code class="xref py py-func docutils literal"><span class="pre">shearVel()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.shearStress">
<code class="descname">shearStress</code><span class="sig-paren">(</span><em>type='effective'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.shearStress" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sum of shear stress values measured on any moving
particles with a finite and fixed velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>type</strong> (<em>str</em>) &#8211; Find the &#8216;defined&#8217; or &#8216;effective&#8217; (default) shear stress</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The shear stress in Pa</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.shearVel">
<code class="descname">shearVel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.shearVel" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias of <a class="reference internal" href="#sphere.sim.shearVelocity" title="sphere.sim.shearVelocity"><code class="xref py py-func docutils literal"><span class="pre">shearVelocity()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.shearVelocity">
<code class="descname">shearVelocity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.shearVelocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates and returns the current shear velocity. The displacement
is found by determining the total x-axis velocity of the upper,
fixed particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The shear velocity [m/s]</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#sphere.sim.shearStrainRate" title="sphere.sim.shearStrainRate"><code class="xref py py-func docutils literal"><span class="pre">shearStrainRate()</span></code></a> and <a class="reference internal" href="#sphere.sim.shearDisplacement" title="sphere.sim.shearDisplacement"><code class="xref py py-func docutils literal"><span class="pre">shearDisplacement()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.sheardisp">
<code class="descname">sheardisp</code><span class="sig-paren">(</span><em>graphics_format='pdf'</em>, <em>zslices=32</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.sheardisp" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the particle x-axis displacement against the original vertical
particle position. The plot is saved in the current directory with the
file name &#8216;&lt;simulation id&gt;-sheardisp.&lt;graphics_format&gt;&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the plot in this format</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>coloring=array([]</em>, <em>dtype=float64)</em>, <em>resolution=6</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Show a rendering of all particles in a window.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>coloring</strong> (<em>numpy.array</em>) &#8211; Color the particles from red to white to blue according
to the values in this array.</li>
<li><strong>resolution</strong> (<em>int</em>) &#8211; The resolution of the rendered spheres. Larger values
increase the performance requirements.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.smallestMass">
<code class="descname">smallestMass</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.smallestMass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mass of the leightest particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int</em>) &#8211; Particle index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The mass of the particle [kg]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.staticGrid">
<code class="descname">staticGrid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.staticGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the height of the fluid grid to be constant as set in <cite>self.L[2]</cite>.</p>
<p>See also <a class="reference internal" href="#sphere.sim.adaptiveGrid" title="sphere.sim.adaptiveGrid"><code class="xref py py-func docutils literal"><span class="pre">adaptiveGrid()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.status">
<code class="descname">status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current simulation status by using the simulation id
(<code class="docutils literal"><span class="pre">sid</span></code>) as an identifier.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The number of the last output file written</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.surfaceArea">
<code class="descname">surfaceArea</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.surfaceArea" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the surface area of a particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int</em>) &#8211; Particle index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The surface area of the particle [m^2]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.thinsection_x1x3">
<code class="descname">thinsection_x1x3</code><span class="sig-paren">(</span><em>x2='center'</em>, <em>graphics_format='png'</em>, <em>cbmax=None</em>, <em>arrowscale=0.01</em>, <em>velarrowscale=1.0</em>, <em>slipscale=1.0</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.thinsection_x1x3" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a 2D image of particles on a x1,x3 plane, intersecting the
second axis at x2. Output is saved as &#8216;&lt;sid&gt;-ts-x1x3.txt&#8217; in the
current folder.</p>
<p>An upper limit to the pressure color bar range can be set by the
cbmax parameter.</p>
<dl class="docutils">
<dt>The data can be plotted in gnuplot with:</dt>
<dd>gnuplot&gt; set size ratio -1
gnuplot&gt; set palette defined (0 &#8220;blue&#8221;, 0.5 &#8220;gray&#8221;, 1 &#8220;red&#8221;)
gnuplot&gt; plot &#8216;&lt;sid&gt;-ts-x1x3.txt&#8217; with circles palette fs                     transparent solid 0.4 noborder</dd>
</dl>
<p>This function also saves a plot of the inter-particle slip angles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x2</strong> (<em>foat</em>) &#8211; The position along the second axis of the intersecting plane</li>
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; Save the slip angle plot in this format</li>
<li><strong>cbmax</strong> (<em>float</em>) &#8211; The maximal value of the pressure color bar range</li>
<li><strong>arrowscale</strong> (<em>float</em>) &#8211; Scale the rotational arrows by this value</li>
<li><strong>velarrowscale</strong> (<em>float</em>) &#8211; Scale the translational arrows by this value</li>
<li><strong>slipscale</strong> (<em>float</em>) &#8211; Scale the slip arrows by this value</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show function output during calculations</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.torqueScript">
<code class="descname">torqueScript</code><span class="sig-paren">(</span><em>email='adc&#64;geo.au.dk'</em>, <em>email_alerts='ae'</em>, <em>walltime='24:00:00'</em>, <em>queue='qfermi'</em>, <em>cudapath='/com/cuda/4.0.17/cuda'</em>, <em>spheredir='/home/adc/code/sphere'</em>, <em>use_workdir=False</em>, <em>workdir='/scratch'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.torqueScript" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a job script for the Torque queue manager for the simulation
object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>email</strong> (<em>str</em>) &#8211; The e-mail address that Torque messages should be sent to</li>
<li><strong>email_alerts</strong> (<em>str</em>) &#8211; The type of Torque messages to send to the e-mail
address. The character &#8216;b&#8217; causes a mail to be sent when the
execution begins. The character &#8216;e&#8217; causes a mail to be sent when
the execution ends normally. The character &#8216;a&#8217; causes a mail to be
sent if the execution ends abnormally. The characters can be written
in any order.</li>
<li><strong>walltime</strong> (<em>str</em>) &#8211; The maximal allowed time for the job, in the format
&#8216;HH:MM:SS&#8217;.</li>
<li><strong>queue</strong> (<em>str</em>) &#8211; The Torque queue to schedule the job for</li>
<li><strong>cudapath</strong> (<em>str</em>) &#8211; The path of the CUDA library on the cluster compute
nodes</li>
<li><strong>spheredir</strong> (<em>str</em>) &#8211; The path to the root directory of sphere on the
cluster</li>
<li><strong>use_workdir</strong> (<em>bool</em>) &#8211; Use a different working directory than the sphere
folder</li>
<li><strong>workdir</strong> (<em>str</em>) &#8211; The working directory during the calculations, if
<cite>use_workdir=True</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.torqueScriptPenguin">
<code class="descname">torqueScriptPenguin</code><span class="sig-paren">(</span><em>email='adc&#64;geo.au.dk'</em>, <em>email_alerts='ae'</em>, <em>walltime='1920:00:00'</em>, <em>queue='H30G'</em>, <em>spheredir='/home/adc/code/sphere'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.torqueScriptPenguin" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a job script for the Torque queue manager for the simulation
object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>email</strong> (<em>str</em>) &#8211; The e-mail address that Torque messages should be sent to</li>
<li><strong>email_alerts</strong> (<em>str</em>) &#8211; The type of Torque messages to send to the e-mail
address. The character &#8216;b&#8217; causes a mail to be sent when the
execution begins. The character &#8216;e&#8217; causes a mail to be sent when
the execution ends normally. The character &#8216;a&#8217; causes a mail to be
sent if the execution ends abnormally. The characters can be written
in any order.</li>
<li><strong>walltime</strong> (<em>str</em>) &#8211; The maximal allowed time for the job, in the format
&#8216;HH:MM:SS&#8217;.</li>
<li><strong>queue</strong> (<em>str</em>) &#8211; The Torque queue to schedule the job for</li>
<li><strong>spheredir</strong> (<em>str</em>) &#8211; The path to the root directory of sphere on the
cluster</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.totalFrictionalEnergy">
<code class="descname">totalFrictionalEnergy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.totalFrictionalEnergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total frictional dissipated energy for all particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The total frictional energy lost of all particles [J]</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.totalKineticEnergy">
<code class="descname">totalKineticEnergy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.totalKineticEnergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total linear kinetic energy for all particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The kinetic energy of all particles [J]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.totalMass">
<code class="descname">totalMass</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.totalMass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total mass of all particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The total mass  in [kg]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.totalMomentum">
<code class="descname">totalMomentum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.totalMomentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sum of particle momentums.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The sum of particle momentums (m*v) [N*s]</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.totalRotationalEnergy">
<code class="descname">totalRotationalEnergy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.totalRotationalEnergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total rotational kinetic energy for all particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The rotational energy of all particles [J]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.totalViscousEnergy">
<code class="descname">totalViscousEnergy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.totalViscousEnergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total viscous dissipated energy for all particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The normal viscous energy lost by all particles [J]</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.triaxial">
<code class="descname">triaxial</code><span class="sig-paren">(</span><em>wvel=-0.001</em>, <em>normal_stress=10000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.triaxial" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup triaxial experiment. The upper wall is moved at a fixed velocity
in m/s, default values is -0.001 m/s (i.e. downwards). The side walls
are exerting a defined normal stress.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>wvel</strong> (<em>float</em>) &#8211; Upper wall velocity. Negative values mean that the wall
moves downwards.</li>
<li><strong>normal_stress</strong> (<em>float</em>) &#8211; The normal stress to apply from the upper wall.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.uniaxialStrainRate">
<code class="descname">uniaxialStrainRate</code><span class="sig-paren">(</span><em>wvel=-0.001</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.uniaxialStrainRate" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup consolidation experiment. Specify the upper wall velocity in m/s,
default value is -0.001 m/s (i.e. downwards).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>wvel</strong> (<em>float</em>) &#8211; Upper wall velocity. Negative values mean that the wall
moves downwards.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.video">
<code class="descname">video</code><span class="sig-paren">(</span><em>out_folder='./'</em>, <em>video_format='mp4'</em>, <em>graphics_folder='../img_out/'</em>, <em>graphics_format='png'</em>, <em>fps=25</em>, <em>qscale=1</em>, <em>bitrate=1800</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.video" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses ffmpeg to combine images to animation. All images should be
rendered beforehand using <a class="reference internal" href="#sphere.render" title="sphere.render"><code class="xref py py-func docutils literal"><span class="pre">render()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>out_folder</strong> (<em>str</em>) &#8211; The output folder for the video file</li>
<li><strong>video_format</strong> (<em>str</em>) &#8211; The format of the output video</li>
<li><strong>graphics_folder</strong> (<em>str</em>) &#8211; The folder containing the rendered images</li>
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; The format of the rendered images</li>
<li><strong>fps</strong> (<em>int</em>) &#8211; The number of frames per second to use in the video</li>
<li><strong>qscale</strong> (<em>float</em>) &#8211; The output video quality, in ]0;1]</li>
<li><strong>bitrate</strong> (<em>int</em>) &#8211; The bitrate to use in the output video</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show ffmpeg output</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.viscousEnergy">
<code class="descname">viscousEnergy</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.viscousEnergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the viscous dissipated energy for a particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int</em>) &#8211; Particle index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The energy lost by the particle by viscous dissipation [J]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.visualize">
<code class="descname">visualize</code><span class="sig-paren">(</span><em>method='energy'</em>, <em>savefig=True</em>, <em>outformat='png'</em>, <em>figsize=False</em>, <em>pickle=False</em>, <em>xlim=False</em>, <em>firststep=0</em>, <em>f_min=None</em>, <em>f_max=None</em>, <em>cmap=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize output from the simulation, where the temporal progress is
of interest. The output will be saved in the current folder with a name
combining the simulation id of the simulation, and the visualization
method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method</strong> (<em>str</em>) &#8211; The type of plot to render. Possible values are &#8216;energy&#8217;,
&#8216;walls&#8217;, &#8216;triaxial&#8217;, &#8216;inertia&#8217;, &#8216;mean-fluid-pressure&#8217;,
&#8216;fluid-pressure&#8217;, &#8216;shear&#8217;, &#8216;shear-displacement&#8217;, &#8216;porosity&#8217;,
&#8216;rate-dependence&#8217;, &#8216;contacts&#8217;</li>
<li><strong>savefig</strong> (<em>bool</em>) &#8211; Save the image instead of showing it on screen</li>
<li><strong>outformat</strong> &#8211; The output format of the plot data. This can be an
image format, or in text (&#8216;txt&#8217;).</li>
<li><strong>figsize</strong> (<em>array</em>) &#8211; Specify output figure size in inches</li>
<li><strong>pickle</strong> (<em>bool</em>) &#8211; Save all figure content as a Python pickle file. It can
be opened later using <cite>fig = pickle.load(open(&#8216;file.pickle&#8217;,&#8217;rb&#8217;))</cite>.</li>
<li><strong>xlim</strong> (<em>array</em>) &#8211; Set custom limits to the x axis. If not specified, the x
range will correspond to the entire data interval.</li>
<li><strong>firststep</strong> (<em>int</em>) &#8211; The first output file step to read (default: 0)</li>
<li><strong>cmap</strong> (<em>matplotlib.colors.LinearSegmentedColormap</em>) &#8211; Choose custom color map, e.g.
<cite>cmap=matplotlib.cm.get_cmap(&#8216;afmhot&#8217;)</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.voidRatio">
<code class="descname">voidRatio</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.voidRatio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the current void ratio</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The void ratio, in [0:1]</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.volume">
<code class="descname">volume</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the volume of a particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int</em>) &#8211; Particle index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The volume of the particle [m^3]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.wall0iz">
<code class="descname">wall0iz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.wall0iz" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the cell index of wall 0 along z.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">z cell index</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.wet">
<code class="descname">wet</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.wet" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the simulation to be wet (total fluid saturation).</p>
<p>See also <a class="reference internal" href="#sphere.sim.dry" title="sphere.sim.dry"><code class="xref py py-func docutils literal"><span class="pre">dry()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.writeFluidVTK">
<code class="descname">writeFluidVTK</code><span class="sig-paren">(</span><em>folder='../output/'</em>, <em>cell_centered=True</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.writeFluidVTK" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a VTK file for the fluid grid to the <code class="docutils literal"><span class="pre">../output/</span></code> folder by
default. The file name will be in the format <code class="docutils literal"><span class="pre">fluid-&lt;self.sid&gt;.vti</span></code>.
The vti files can be used for visualizing the fluid in ParaView.</p>
<p>The scalars (pressure, porosity, porosity change) and the velocity
vectors are either placed in a grid where the grid corners correspond to
the computational grid center (cell_centered = False). This results in a
grid that doesn&#8217;t appears to span the simulation domain, and values are
smoothly interpolated on the cell faces. Alternatively, the
visualization grid is equal to the computational grid, and cells face
colors are not interpolated (cell_centered = True, default behavior).</p>
<p>The fluid grid is visualized by opening the vti files, and pressing
&#8220;Apply&#8221; to import all fluid field properties. To visualize the scalar
fields, such as the pressure, the porosity, the porosity change or the
velocity magnitude, choose &#8220;Surface&#8221; or &#8220;Surface With Edges&#8221; as the
&#8220;Representation&#8221;. Choose the desired property as the &#8220;Coloring&#8221; field.
It may be desirable to show the color bar by pressing the &#8220;Show&#8221; button,
and &#8220;Rescale&#8221; to fit the color range limits to the current file. The
coordinate system can be displayed by checking the &#8220;Show Axis&#8221; field.
All adjustments by default require the &#8220;Apply&#8221; button to be pressed
before regenerating the view.</p>
<p>The fluid vector fields (e.g. the fluid velocity) can be visualizing by
e.g. arrows. To do this, select the fluid data in the &#8220;Pipeline
Browser&#8221;. Press &#8220;Glyph&#8221; from the &#8220;Common&#8221; toolbar, or go to the
&#8220;Filters&#8221; mennu, and press &#8220;Glyph&#8221; from the &#8220;Common&#8221; list. Make sure
that &#8220;Arrow&#8221; is selected as the &#8220;Glyph type&#8221;, and &#8220;Velocity&#8221; as the
&#8220;Vectors&#8221; value. Adjust the &#8220;Maximum Number of Points&#8221; to be at least as
big as the number of fluid cells in the grid. Press &#8220;Apply&#8221; to visualize
the arrows.</p>
<p>To visualize the cell-centered data with smooth interpolation, and in
order to visualize fluid vector fields, the cell-centered mesh is
selected in the &#8220;Pipeline Browser&#8221;, and is filtered using &#8220;Filters&#8221; -&gt;
&#8220;Alphabetical&#8221; -&gt; &#8220;Cell Data to Point Data&#8221;.</p>
<p>If several data files are generated for the same simulation (e.g. using
the <a class="reference internal" href="#sphere.sim.writeVTKall" title="sphere.sim.writeVTKall"><code class="xref py py-func docutils literal"><span class="pre">writeVTKall()</span></code></a> function), it is able to step the
visualization through time by using the ParaView controls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>folder</strong> (<em>str</em>) &#8211; The folder where to place the output binary file (default
(default = &#8216;../output/&#8217;)</li>
<li><strong>cell_centered</strong> (<em>bool</em>) &#8211; put scalars and vectors at cell centers (True) or
cell corners (False), (default = True)</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show diagnostic information (default = True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.writeVTK">
<code class="descname">writeVTK</code><span class="sig-paren">(</span><em>folder='../output/'</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.writeVTK" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a VTK file with particle information to the <code class="docutils literal"><span class="pre">../output/</span></code> folder
by default. The file name will be in the format <code class="docutils literal"><span class="pre">&lt;self.sid&gt;.vtu</span></code>.
The vtu files can be used to visualize the particles in ParaView.</p>
<p>After opening the vtu files, the particle fields will show up in the
&#8220;Properties&#8221; list. Press &#8220;Apply&#8221; to import all fields into the ParaView
session. The particles are visualized by selecting the imported data in
the &#8220;Pipeline Browser&#8221;. Afterwards, click the &#8220;Glyph&#8221; button in the
&#8220;Common&#8221; toolbar, or go to the &#8220;Filters&#8221; menu, and press &#8220;Glyph&#8221; from
the &#8220;Common&#8221; list. Choose &#8220;Sphere&#8221; as the &#8220;Glyph Type&#8221;, choose &#8220;scalar&#8221;
as the &#8220;Scale Mode&#8221;. Check the &#8220;Edit&#8221; checkbox, and set the &#8220;Set Scale
Factor&#8221; to 1.0. The field &#8220;Maximum Number of Points&#8221; may be increased if
the number of particles exceed the default value. Finally press &#8220;Apply&#8221;,
and the particles will appear in the main window.</p>
<p>The sphere resolution may be adjusted (&#8220;Theta resolution&#8221;, &#8220;Phi
resolution&#8221;) to increase the quality and the computational requirements
of the rendering. All adjustments by default require the &#8220;Apply&#8221; button
to be pressed before regenerating the view.</p>
<p>If several vtu files are generated for the same simulation (e.g. using
the <a class="reference internal" href="#sphere.sim.writeVTKall" title="sphere.sim.writeVTKall"><code class="xref py py-func docutils literal"><span class="pre">writeVTKall()</span></code></a> function), it is able to step the
visualization through time by using the ParaView controls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>folder</strong> (<em>str</em>) &#8211; The folder where to place the output binary file (default
(default = &#8216;../output/&#8217;)</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show diagnostic information (default = True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.writeVTKall">
<code class="descname">writeVTKall</code><span class="sig-paren">(</span><em>cell_centered=True</em>, <em>verbose=True</em>, <em>forces=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.writeVTKall" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a VTK file for each simulation output file with particle
information and the fluid grid to the <code class="docutils literal"><span class="pre">../output/</span></code> folder by default.
The file name will be in the format <code class="docutils literal"><span class="pre">&lt;self.sid&gt;.vtu</span></code> and
<code class="docutils literal"><span class="pre">fluid-&lt;self.sid&gt;.vti</span></code>. The vtu files can be used to visualize the
particles, and the vti files for visualizing the fluid in ParaView.</p>
<p>After opening the vtu files, the particle fields will show up in the
&#8220;Properties&#8221; list. Press &#8220;Apply&#8221; to import all fields into the ParaView
session. The particles are visualized by selecting the imported data in
the &#8220;Pipeline Browser&#8221;. Afterwards, click the &#8220;Glyph&#8221; button in the
&#8220;Common&#8221; toolbar, or go to the &#8220;Filters&#8221; menu, and press &#8220;Glyph&#8221; from
the &#8220;Common&#8221; list. Choose &#8220;Sphere&#8221; as the &#8220;Glyph Type&#8221;, set &#8220;Radius&#8221; to
1.0, choose &#8220;scalar&#8221; as the &#8220;Scale Mode&#8221;. Check the &#8220;Edit&#8221; checkbox, and
set the &#8220;Set Scale Factor&#8221; to 1.0. The field &#8220;Maximum Number of Points&#8221;
may be increased if the number of particles exceed the default value.
Finally press &#8220;Apply&#8221;, and the particles will appear in the main window.</p>
<p>The sphere resolution may be adjusted (&#8220;Theta resolution&#8221;, &#8220;Phi
resolution&#8221;) to increase the quality and the computational requirements
of the rendering.</p>
<p>The fluid grid is visualized by opening the vti files, and pressing
&#8220;Apply&#8221; to import all fluid field properties. To visualize the scalar
fields, such as the pressure, the porosity, the porosity change or the
velocity magnitude, choose &#8220;Surface&#8221; or &#8220;Surface With Edges&#8221; as the
&#8220;Representation&#8221;. Choose the desired property as the &#8220;Coloring&#8221; field.
It may be desirable to show the color bar by pressing the &#8220;Show&#8221; button,
and &#8220;Rescale&#8221; to fit the color range limits to the current file. The
coordinate system can be displayed by checking the &#8220;Show Axis&#8221; field.
All adjustments by default require the &#8220;Apply&#8221; button to be pressed
before regenerating the view.</p>
<p>The fluid vector fields (e.g. the fluid velocity) can be visualizing by
e.g. arrows. To do this, select the fluid data in the &#8220;Pipeline
Browser&#8221;. Press &#8220;Glyph&#8221; from the &#8220;Common&#8221; toolbar, or go to the
&#8220;Filters&#8221; mennu, and press &#8220;Glyph&#8221; from the &#8220;Common&#8221; list. Make sure
that &#8220;Arrow&#8221; is selected as the &#8220;Glyph type&#8221;, and &#8220;Velocity&#8221; as the
&#8220;Vectors&#8221; value. Adjust the &#8220;Maximum Number of Points&#8221; to be at least as
big as the number of fluid cells in the grid. Press &#8220;Apply&#8221; to visualize
the arrows.</p>
<p>If several data files are generated for the same simulation (e.g. using
the <a class="reference internal" href="#sphere.sim.writeVTKall" title="sphere.sim.writeVTKall"><code class="xref py py-func docutils literal"><span class="pre">writeVTKall()</span></code></a> function), it is able to step the
visualization through time by using the ParaView controls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show diagnostic information (default = True)</li>
<li><strong>cell_centered</strong> (<em>bool</em>) &#8211; Write fluid values to cell centered positions
(default = true)</li>
<li><strong>forces</strong> (<em>bool</em>) &#8211; Write contact force files (slow) (default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.writeVTKforces">
<code class="descname">writeVTKforces</code><span class="sig-paren">(</span><em>folder='../output/'</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.writeVTKforces" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a VTK file with particle-interaction information to the
<code class="docutils literal"><span class="pre">../output/</span></code> folder by default. The file name will be in the format
<code class="docutils literal"><span class="pre">&lt;self.sid&gt;.vtp</span></code>.  The vtp files can be used to visualize the
particle interactions in ParaView.  First use the &#8220;Cell Data to Point
Data&#8221; filter, and afterwards show the contact network with the &#8220;Tube&#8221;
filter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>folder</strong> (<em>str</em>) &#8211; The folder where to place the output file (default
(default = &#8216;../output/&#8217;)</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show diagnostic information (default = True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.writebin">
<code class="descname">writebin</code><span class="sig-paren">(</span><em>folder='../input/'</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.writebin" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <code class="docutils literal"><span class="pre">sphere</span></code> binary file to the <code class="docutils literal"><span class="pre">../input/</span></code> folder by default.
The file name will be in the format <code class="docutils literal"><span class="pre">&lt;self.sid&gt;.bin</span></code>.</p>
<p>See also <a class="reference internal" href="#sphere.sim.readbin" title="sphere.sim.readbin"><code class="xref py py-func docutils literal"><span class="pre">readbin()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>folder</strong> (<em>str</em>) &#8211; The folder where to place the output binary file</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show diagnostic information (default = True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sphere.sim.zeroKinematics">
<code class="descname">zeroKinematics</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sphere.sim.zeroKinematics" title="Permalink to this definition">¶</a></dt>
<dd><p>Zero all kinematic parameters of the particles. This function is useful
when output from one simulation is reused in another simulation.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sphere.status">
<code class="descclassname">sphere.</code><code class="descname">status</code><span class="sig-paren">(</span><em>project</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the status.dat file for the target project, and return the last output
file number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>project</strong> (<em>str</em>) &#8211; The simulation id of the target project</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The last output file written in the simulation calculations</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sphere.thinsectionVideo">
<code class="descclassname">sphere.</code><code class="descname">thinsectionVideo</code><span class="sig-paren">(</span><em>project</em>, <em>out_folder='./'</em>, <em>video_format='mp4'</em>, <em>fps=25</em>, <em>qscale=1</em>, <em>bitrate=1800</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.thinsectionVideo" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses ffmpeg to combine thin section images to an animation. This function
will implicity render the thin section images beforehand.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>project</strong> (<em>str</em>) &#8211; The simulation id of the project to render</li>
<li><strong>out_folder</strong> (<em>str</em>) &#8211; The output folder for the video file</li>
<li><strong>video_format</strong> (<em>str</em>) &#8211; The format of the output video</li>
<li><strong>fps</strong> (<em>int</em>) &#8211; The number of frames per second to use in the video</li>
<li><strong>qscale</strong> (<em>float</em>) &#8211; The output video quality, in ]0;1]</li>
<li><strong>bitrate</strong> (<em>int</em>) &#8211; The bitrate to use in the output video</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show ffmpeg output</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sphere.torqueScriptParallel3">
<code class="descclassname">sphere.</code><code class="descname">torqueScriptParallel3</code><span class="sig-paren">(</span><em>obj1</em>, <em>obj2</em>, <em>obj3</em>, <em>email='adc&#64;geo.au.dk'</em>, <em>email_alerts='ae'</em>, <em>walltime='24:00:00'</em>, <em>queue='qfermi'</em>, <em>cudapath='/com/cuda/4.0.17/cuda'</em>, <em>spheredir='/home/adc/code/sphere'</em>, <em>use_workdir=False</em>, <em>workdir='/scratch'</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.torqueScriptParallel3" title="Permalink to this definition">¶</a></dt>
<dd><p>Create job script for the Torque queue manager for three binaries,
executed in parallel, ideally on three GPUs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>email</strong> (<em>str</em>) &#8211; The e-mail address that Torque messages should be sent to</li>
<li><strong>email_alerts</strong> (<em>str</em>) &#8211; The type of Torque messages to send to the e-mail
address. The character &#8216;b&#8217; causes a mail to be sent when the
execution begins. The character &#8216;e&#8217; causes a mail to be sent when
the execution ends normally. The character &#8216;a&#8217; causes a mail to be
sent if the execution ends abnormally. The characters can be written
in any order.</li>
<li><strong>walltime</strong> (<em>str</em>) &#8211; The maximal allowed time for the job, in the format
&#8216;HH:MM:SS&#8217;.</li>
<li><strong>queue</strong> (<em>str</em>) &#8211; The Torque queue to schedule the job for</li>
<li><strong>cudapath</strong> (<em>str</em>) &#8211; The path of the CUDA library on the cluster compute nodes</li>
<li><strong>spheredir</strong> (<em>str</em>) &#8211; The path to the root directory of sphere on the cluster</li>
<li><strong>use_workdir</strong> (<em>bool</em>) &#8211; Use a different working directory than the sphere folder</li>
<li><strong>workdir</strong> (<em>str</em>) &#8211; The working directory during the calculations, if
<cite>use_workdir=True</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The filename of the script</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
<p>See also <code class="xref py py-func docutils literal"><span class="pre">torqueScript()</span></code></p>
</dd></dl>

<dl class="function">
<dt id="sphere.video">
<code class="descclassname">sphere.</code><code class="descname">video</code><span class="sig-paren">(</span><em>project</em>, <em>out_folder='./'</em>, <em>video_format='mp4'</em>, <em>graphics_folder='../img_out/'</em>, <em>graphics_format='png'</em>, <em>fps=25</em>, <em>qscale=1</em>, <em>bitrate=1800</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sphere.video" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses ffmpeg to combine images to animation. All images should be
rendered beforehand using <a class="reference internal" href="#sphere.render" title="sphere.render"><code class="xref py py-func docutils literal"><span class="pre">render()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>project</strong> (<em>str</em>) &#8211; The simulation id of the project to render</li>
<li><strong>out_folder</strong> (<em>str</em>) &#8211; The output folder for the video file</li>
<li><strong>video_format</strong> (<em>str</em>) &#8211; The format of the output video</li>
<li><strong>graphics_folder</strong> (<em>str</em>) &#8211; The folder containing the rendered images</li>
<li><strong>graphics_format</strong> (<em>str</em>) &#8211; The format of the rendered images</li>
<li><strong>fps</strong> (<em>int</em>) &#8211; The number of frames per second to use in the video</li>
<li><strong>qscale</strong> (<em>float</em>) &#8211; The output video quality, in ]0;1]</li>
<li><strong>bitrate</strong> (<em>int</em>) &#8211; The bitrate to use in the output video</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Show ffmpeg output</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Python API</a><ul>
<li><a class="reference internal" href="#sample-usage">Sample usage</a></li>
<li><a class="reference internal" href="#module-sphere">The <code class="docutils literal"><span class="pre">sphere</span></code> module</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="cfd.html"
                        title="previous chapter">Fluid simulation and particle-fluid interaction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="sphere_internals.html"
                        title="next chapter">sphere internals</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/python_api.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sphere_internals.html" title="sphere internals"
             >next</a> |</li>
        <li class="right" >
          <a href="cfd.html" title="Fluid simulation and particle-fluid interaction"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">sphere 2.15-beta documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Anders Damsgaard.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.9.
    </div>
  </body>
</html>