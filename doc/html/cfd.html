<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Fluid simulation and particle-fluid interaction &mdash; sphere 0.35 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/breathe.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.35',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="sphere 0.35 documentation" href="index.html" />
    <link rel="next" title="Python API" href="python_api.html" />
    <link rel="prev" title="Discrete element method" href="dem.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="python_api.html" title="Python API"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="dem.html" title="Discrete element method"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">sphere 0.35 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="fluid-simulation-and-particle-fluid-interaction">
<h1>Fluid simulation and particle-fluid interaction<a class="headerlink" href="#fluid-simulation-and-particle-fluid-interaction" title="Permalink to this headline">¶</a></h1>
<p>A new and experimental addition to <em>sphere</em> is the ability to simulate a mixture
of particles and a Newtonian fluid. The fluid is simulated using an Eulerian
continuum approach, using a custom CUDA solver for GPU computation. This
approach allows for fast simulations due to the limited need for GPU-CPU
communications, as well as a flexible code base.</p>
<p>The following sections will describe the theoretical background, as well as the
solution procedure and the numerical implementation.</p>
<div class="section" id="derivation-of-the-navier-stokes-equations-with-porosity">
<h2>Derivation of the Navier Stokes equations with porosity<a class="headerlink" href="#derivation-of-the-navier-stokes-equations-with-porosity" title="Permalink to this headline">¶</a></h2>
<p>Following the outline presented by <a class="reference external" href="http://www.cimec.org.ar/ojs/index.php/mc/article/view/486/464">Limache and Idelsohn (2006)</a>, the
continuity equation for an incompressible fluid material is given by:</p>
<div class="math">
<p><span class="math">\nabla \cdot \boldsymbol{v} = 0</span></p>
</div><p>and the momentum equation:</p>
<div class="math">
<p><span class="math">\rho \frac{\partial \boldsymbol{v}}{\partial t}
+ \rho (\boldsymbol{v} \cdot \nabla \boldsymbol{v})
= \nabla \cdot \boldsymbol{\sigma}
+ \rho \boldsymbol{f}</span></p>
</div><p>Here, <span class="math">\boldsymbol{v}</span> is the fluid velocity, <span class="math">\rho</span> is the
fluid density, <span class="math">\boldsymbol{\sigma}</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Cauchy_stress_tensor">Cauchy stress tensor</a>, and
<span class="math">\boldsymbol{f}</span> is a body force (e.g. gravity). For incompressible
Newtonian fluids, the Cauchy stress is given by:</p>
<div class="math">
<p><span class="math">\boldsymbol{\sigma} = -p \boldsymbol{I} + \boldsymbol{\tau}</span></p>
</div><p><span class="math">p</span> is the fluid pressure, <span class="math">\boldsymbol{I}</span> is the identity
tensor, and <span class="math">\boldsymbol{\tau}</span> is the deviatoric stress tensor, given
by:</p>
<div class="math">
<p><span class="math">\boldsymbol{\tau} =
\nu \nabla \boldsymbol{v}
+ \nu (\nabla \boldsymbol{v})^T</span></p>
</div><p>By using the following vector identities:</p>
<div class="math">
<p><span class="math">\nabla \cdot (p \boldsymbol{I}) = \nabla p

\nabla \cdot (\nabla \boldsymbol{v}) = \nabla^2 \boldsymbol{v}

\nabla \cdot (\nabla \boldsymbol{v})^T
= \nabla (\nabla \cdot \boldsymbol{v})</span></p>
</div><p>the deviatoric component of the Cauchy stress tensor simplifies to the
following, assuming that spatial variations in the viscosity can be neglected:</p>
<div class="math">
<p><span class="math">= -\nabla p
+ \nu \nabla^2 \boldsymbol{v}</span></p>
</div><p>Since we are dealing with fluid flow in a porous medium, additional terms are
introduced to the equations for conservation of mass and momentum. In the
following, the equations are derived for the first spatial component. The
solution for the other components is trivial.</p>
<p>The porosity value (in the saturated porous medium the volumetric fraction of
the fluid phase) denoted <span class="math">\phi</span> is incorporated in the continuity and
momentum equations. The continuity equation becomes:</p>
<div class="math">
<p><span class="math">\frac{\partial \phi}{\partial t}
+ \nabla \cdot (\phi \boldsymbol{v}) = 0</span></p>
</div><p>For the <span class="math">x</span> component, the Lagrangian formulation of the momentum equation
with a body force <span class="math">\boldsymbol{f}</span> becomes:</p>
<div class="math">
<p><span class="math">\frac{D (\phi v_x)}{D t}
= \frac{1}{\rho} \left[ \nabla \cdot (\phi \boldsymbol{\sigma}) \right]_x
+ \phi f_x</span></p>
</div><p>In the Eulerian formulation, an advection term is added, and the Cauchy stress
tensor is represented as isotropic and deviatoric components individually:</p>
<div class="math">
<p><span class="math">\frac{\partial (\phi v_x)}{\partial t}
+ \boldsymbol{v} \cdot \nabla (\phi v_x)
= \frac{1}{\rho} \left[ \nabla \cdot (-\phi p \boldsymbol{I})
+ \phi \boldsymbol{\tau}) \right]_x
+ \phi f_x</span></p>
</div><p>Using vector identities to rewrite the advection term, and expanding the fluid
stress tensor term:</p>
<div class="math">
<p><span class="math">\frac{\partial (\phi v_x)}{\partial t}
+ \nabla \cdot (\phi v_x \boldsymbol{v})
- \phi v_x (\nabla \cdot \boldsymbol{v})
= \frac{1}{\rho} \left[ -\nabla \phi p \right]_x
+ \frac{1}{\rho} \left[ -\phi \nabla p \right]_x
+ \frac{1}{\rho} \left[ \nabla \cdot (\phi \boldsymbol{\tau}) \right]_x
+ \phi f_x</span></p>
</div><p>Spatial variations in the porosity are neglected,</p>
<div class="math">
<p><span class="math">\nabla \phi := 0</span></p>
</div><p>and the pressure is attributed to the fluid phase alone (model B in Zhu et al.
2007 and Zhou et al. 2010). The divergence of fluid velocities is defined to be
zero:</p>
<div class="math">
<p><span class="math">\nabla \cdot \boldsymbol{v} := 0</span></p>
</div><p>With these assumptions, the momentum equation simplifies to:</p>
<div class="math">
<p><span class="math">\frac{\partial (\phi v_x)}{\partial t}
+ \nabla \cdot (\phi v_x \boldsymbol{v})
= -\frac{1}{\rho} \frac{\partial p}{\partial x}
+ \frac{1}{\rho} \left[ \nabla \cdot (\phi \boldsymbol{\tau}) \right]_x
+ \phi f_x</span></p>
</div><p>The remaining part of the advection term is for the <span class="math">x</span> component
found as:</p>
<div class="math">
<p><span class="math">\nabla \cdot (\phi v_x \boldsymbol{v}) =
\left[
    \frac{\partial}{\partial x},
    \frac{\partial}{\partial y},
    \frac{\partial}{\partial z}
\right]
\left[
    \begin{array}{c}
        \phi v_x v_x\\
        \phi v_x v_y\\
        \phi v_x v_z\\
    \end{array}
\right]
=
\frac{\partial (\phi v_x v_x)}{\partial x} +
\frac{\partial (\phi v_x v_y)}{\partial y} +
\frac{\partial (\phi v_x v_z)}{\partial z}</span></p>
</div><p>The deviatoric stress tensor is in this case symmetrical, i.e. <span class="math">\tau_{ij}
= \tau_{ji}</span>, and is found by:</p>
<div class="math">
<p><span class="math">\frac{1}{\rho} \left[ \nabla \cdot (\phi \boldsymbol{\tau}) \right]_x
= \frac{1}{\rho}
\left[
    \left[
        \frac{\partial}{\partial x},
        \frac{\partial}{\partial y},
        \frac{\partial}{\partial z}
    \right]
    \phi
    \left[
        \begin{matrix}
            \tau_{xx} &amp; \tau_{xy} &amp; \tau_{xz}\\
            \tau_{yx} &amp; \tau_{yy} &amp; \tau_{yz}\\
            \tau_{zx} &amp; \tau_{zy} &amp; \tau_{zz}\\
        \end{matrix}
    \right]
\right]_x

= \frac{1}{\rho}
\left[
    \begin{array}{c}
        \frac{\partial (\phi \tau_{xx})}{\partial x}
        + \frac{\partial (\phi \tau_{xy})}{\partial y}
        + \frac{\partial (\phi \tau_{xz})}{\partial z}\\
        \frac{\partial (\phi \tau_{yx})}{\partial x}
        + \frac{\partial (\phi \tau_{yy})}{\partial y}
        + \frac{\partial (\phi \tau_{yz})}{\partial z}\\
        \frac{\partial (\phi \tau_{zx})}{\partial x}
        + \frac{\partial (\phi \tau_{zy})}{\partial y}
        + \frac{\partial (\phi \tau_{zz})}{\partial z}\\
    \end{array}
\right]_x
= \frac{1}{\rho}
\left(
    \frac{\partial (\phi \tau_{xx})}{\partial x}
    + \frac{\partial (\phi \tau_{xy})}{\partial y}
    + \frac{\partial (\phi \tau_{xz})}{\partial z}
\right)</span></p>
</div><p>In a linear viscous fluid, the stress and strain rate
(<span class="math">\dot{\boldsymbol{\epsilon}}</span>) is linearly dependent, scaled by the
viscosity parameter <span class="math">\nu</span>:</p>
<div class="math">
<p><span class="math">\tau_{ij} = 2 \nu \dot{\epsilon}_{ij}
= \nu \left(
\frac{\partial v_i}{\partial x_j} + \frac{\partial v_j}{\partial x_i}
\right)</span></p>
</div><p>With this relationship, the deviatoric stress tensor components can be
calculated as:</p>
<div class="math">
<p><span class="math">\tau_{xx} = 2 \nu \frac{\partial v_x}{\partial x} \qquad
\tau_{yy} = 2 \nu \frac{\partial v_y}{\partial y} \qquad
\tau_{zz} = 2 \nu \frac{\partial v_z}{\partial z}

\tau_{xy} = \nu \left(
\frac{\partial v_x}{\partial y} + \frac{\partial v_y}{\partial x} \right)

\tau_{xz} = \nu \left(
\frac{\partial v_x}{\partial z} + \frac{\partial v_z}{\partial x} \right)

\tau_{yz} = \nu \left(
\frac{\partial v_y}{\partial z} + \frac{\partial v_z}{\partial y} \right)</span></p>
</div><p>The above formulation of the fluid rheology assumes identical bulk and shear
viscosities. The derivation of the equations for the other spatial components
is trivial.</p>
</div>
<div class="section" id="porosity-estimation">
<h2>Porosity estimation<a class="headerlink" href="#porosity-estimation" title="Permalink to this headline">¶</a></h2>
<p>&#8212;</p>
</div>
<div class="section" id="solution-procedure-by-operator-splitting">
<h2>Solution procedure by operator splitting<a class="headerlink" href="#solution-procedure-by-operator-splitting" title="Permalink to this headline">¶</a></h2>
<p>The partial differential terms in the previously described equations are found
using finite central differences. Modifying the operator splitting methodology
presented by Langtangen et al.  (2002), the predicted velocity
<span class="math">\boldsymbol{v}^*</span> after a finite time step
<span class="math">\Delta t</span> is found by explicit integration of the momentum equation.</p>
<div class="math">
<p><span class="math">\frac{\Delta (\phi v_x)}{\Delta t}
+ \nabla \cdot (\phi v_x \boldsymbol{v})
= - \frac{1}{\rho} \frac{\Delta p}{\Delta x}
+ \frac{1}{\rho} \left[ \nabla \cdot (\phi \boldsymbol{\tau}) \right]_x
+ \phi f_x

\Downarrow

\phi \frac{\Delta v_x}{\Delta t}
+ v_x \frac{\Delta \phi}{\Delta t}
+ \nabla \cdot (\phi v_x \boldsymbol{v})
= - \frac{1}{\rho} \frac{\Delta p}{\Delta x}
+ \frac{1}{\rho} \left[ \nabla \cdot (\phi \boldsymbol{\tau}) \right]_x
+ \phi f_x</span></p>
</div><p>We want to isolate <span class="math">\Delta v_x</span> in the above equation in order to project
the new velocity.</p>
<div class="math">
<p><span class="math">\phi \frac{\Delta v_x}{\Delta t}
= - \frac{1}{\rho} \frac{\Delta p}{\Delta x}
+ \frac{1}{\rho} \left[ \nabla \cdot (\phi \boldsymbol{\tau}) \right]_x
+ \phi f_x
- v_x \frac{\Delta \phi}{\Delta t}
- \nabla \cdot (\phi v_x \boldsymbol{v})

\Delta v_x
= - \frac{1}{\rho} \frac{\Delta p}{\Delta x} \frac{\Delta t}{\phi}
+ \frac{1}{\rho} \left[ \nabla \cdot (\phi \boldsymbol{\tau}) \right]_x
  \frac{\Delta t}{\phi}
+ \Delta t f_x
- v_x \frac{\Delta \phi}{\phi}
- \nabla \cdot (\phi v_x \boldsymbol{v}) \frac{\Delta t}{\phi}</span></p>
</div><p>The term <span class="math">\beta</span> is introduced as an adjustable, dimensionless parameter
in the range <span class="math">[0;1]</span>, and determines the importance of the old pressure
values in the solution procedure (Langtangen et al. 2002).  A value of 0
corresponds to <a class="reference external" href="https://en.wikipedia.org/wiki/Projection_method_(fluid_dynamics)#Chorin.27s_projection_method">Chorin&#8217;s projection method</a> originally described
in <a class="reference external" href="http://www.ams.org/journals/mcom/1968-22-104/S0025-5718-1968-0242392-2/S0025-5718-1968-0242392-2.pdf">Chorin (1968)</a>.</p>
<div class="math">
<p><span class="math">v_x^* = v_x^t + \Delta v_x

v_x^* = v_x^t
- \frac{\beta}{\rho} \frac{\Delta p^t}{\Delta x} \frac{\Delta t}{\phi^t}
+ \frac{1}{\rho} \left[ \nabla \cdot (\phi^t \boldsymbol{\tau}^t) \right]_x
  \frac{\Delta t}{\phi}
+ \Delta t f_x
- v^t_x \frac{\Delta \phi}{\phi^t}
- \nabla \cdot (\phi^t v_x^t \boldsymbol{v}^t) \frac{\Delta t}{\phi^t}</span></p>
</div><p>Here, <span class="math">\Delta x</span> denotes the cell spacing. The velocity found
(<span class="math">v_x^*</span>) is only a prediction of the fluid velocity at time
<span class="math">t+\Delta t</span>, since the estimate isn&#8217;t constrained by the continuity
equation:</p>
<div class="math">
<p><span class="math">\frac{\Delta \phi^t}{\Delta t} + \nabla \cdot (\phi^t
\boldsymbol{v}^{t+\Delta t}) = 0</span></p>
</div><p>The divergence of a scalar and vector can be <a class="reference external" href="http://www.wolframalpha.com/input/?i=div(p+v)">split</a>:</p>
<div class="math">
<p><span class="math">\phi^t \nabla \cdot \boldsymbol{v}^{t+\Delta t} +
\boldsymbol{v}^{t+\Delta t} \cdot \nabla \phi^t
+ \frac{\Delta \phi^t}{\Delta t} = 0</span></p>
</div><p>The predicted velocity is corrected using the new pressure (Langtangen et al.
2002):</p>
<div class="math">
<p><span class="math">\boldsymbol{v}^{t+\Delta t} = \boldsymbol{v}^*
- \frac{\Delta t}{\rho} \nabla \epsilon
\quad \text{where} \quad
\epsilon = p^{t+\Delta t} - \beta p^t</span></p>
</div><p>The above formulation of the future velocity is put into the continuity
equation:</p>
<div class="math">
<p><span class="math">\Rightarrow
\phi^t \nabla \cdot
\left( \boldsymbol{v}^* - \frac{\Delta t}{\rho} \nabla \epsilon \right)
+
\left( \boldsymbol{v}^* - \frac{\Delta t}{\rho} \nabla \epsilon \right)
\cdot \nabla \phi^t + \frac{\Delta \phi^t}{\Delta t} = 0</span></p>
</div><div class="math">
<p><span class="math">\Rightarrow
\phi^t \nabla \cdot
\boldsymbol{v}^* - \frac{\Delta t}{\rho} \phi^t \nabla^2 \epsilon
+ \nabla \phi^t \cdot \boldsymbol{v}^*
- \nabla \phi^t \cdot \nabla \epsilon \frac{\Delta t}{\rho}
+ \frac{\Delta \phi^t}{\Delta t} = 0</span></p>
</div><div class="math">
<p><span class="math">\Rightarrow
\frac{\Delta t}{\rho} \phi^t \nabla^2 \epsilon
= \phi^t \nabla \cdot \boldsymbol{v}^*
+ \nabla \phi^t \cdot \boldsymbol{v}^*
- \nabla \phi^t \cdot \nabla \epsilon \frac{\Delta t}{\rho}
+ \frac{\Delta \phi^t}{\Delta t}</span></p>
</div><p>The pressure difference in time becomes a <a class="reference external" href="https://en.wikipedia.org/wiki/Poisson's_equation">Poisson equation</a> with added terms:</p>
<div class="math">
<p><span class="math">\Rightarrow
\nabla^2 \epsilon
= \frac{\nabla \cdot \boldsymbol{v}^* \rho}{\Delta t}
+ \frac{\nabla \phi^t \cdot \boldsymbol{v}^* \rho}{\Delta t \phi^t}
- \frac{\nabla \phi^t \cdot \nabla \epsilon}{\phi^t}
+ \frac{\Delta \phi^t \rho}{\Delta t^2 \phi^t}</span></p>
</div><p>The right hand side of the above equation is termed the <em>forcing function</em>
<span class="math">f</span>, which is decomposed into two terms, <span class="math">f_1</span> and <span class="math">f_2</span>:</p>
<div class="math">
<p><span class="math">f_1
= \frac{\nabla \cdot \boldsymbol{v}^* \rho}{\Delta t}
+ \frac{\nabla \phi^t \cdot \boldsymbol{v}^* \rho}{\Delta t \phi^t}
+ \frac{\Delta \phi^t \rho}{\Delta t^2 \phi^t}

f_2 =
\frac{\nabla \phi^t \cdot \nabla \epsilon}{\phi^t}</span></p>
</div><p>During the <a class="reference external" href="http://www.rsmas.miami.edu/personal/miskandarani/Courses/MSC321/Projects/prjpoisson.pdf">Jacobi iterative solution procedure</a> <span class="math">f_1</span> remains constant,
while <span class="math">f_2</span> changes value. For this reason, <span class="math">f_1</span> is found only
during the first iteration, while <span class="math">f_2</span> is updated every time. The value
of the forcing function is found as:</p>
<div class="math">
<p><span class="math">f = f_1 - f_2</span></p>
</div><p>Using second-order finite difference approximations of the Laplace operator
second-order partial derivatives, the differential equations become a system of
equations that is solved using <a class="reference external" href="https://en.wikipedia.org/wiki/Relaxation_(iterative_method)">iteratively</a> using Jacobi updates. The total
number of unknowns is <span class="math">(n_x - 1)(n_y - 1)(n_z - 1)</span>.</p>
<p>The discrete Laplacian (approximation of the Laplace operator) can be obtained
by a finite-difference seven-point stencil in a three-dimensional, cubic
grid with cell spacing <span class="math">\Delta x, \Delta y, \Delta z</span>, considering the six
face neighbors:</p>
<div class="math">
<p><span class="math">\nabla^2 \epsilon_{i_x,i_y,i_z}  \approx
\frac{\epsilon_{i_x-1,i_y,i_z} - 2 \epsilon_{i_x,i_y,i_z}
+ \epsilon_{i_x+1,i_y,i_z}}{\Delta x^2}
+ \frac{\epsilon_{i_x,i_y-1,i_z} - 2 \epsilon_{i_x,i_y,i_z}
+ \epsilon_{i_x,i_y+1,i_z}}{\Delta y^2}

+ \frac{\epsilon_{i_x,i_y,i_z-1} - 2 \epsilon_{i_x,i_y,i_z}
+ \epsilon_{i_x,i_y,i_z+1}}{\Delta z^2}
\approx f_{i_x,i_y,i_z}</span></p>
</div><p>Within a Jacobi iteration, the value of the unknowns (<span class="math">\epsilon^n</span>) is
used to find an updated solution estimate (<span class="math">\epsilon^{n+1}</span>).
The solution for the updated value takes the form:</p>
<div class="math">
<p><span class="math">\epsilon^{n+1}_{i_x,i_y,i_z}
= \frac{-\Delta x^2 \Delta y^2 \Delta z^2 f_{i_x,i_y,i_z}
+ \Delta y^2 \Delta z^2 (\epsilon^n_{i_x-1,i_y,i_z} +
  \epsilon^n_{i_x+1,i_y,i_z})
+ \Delta x^2 \Delta z^2 (\epsilon^n_{i_x,i_y-1,i_z} +
  \epsilon^n_{i_x,i_y+1,i_z})
+ \Delta x^2 \Delta y^2 (\epsilon^n_{i_x,i_y,i_z-1} +
  \epsilon^n_{i_x,i_y,i_z+1})}
  {2 (\Delta x^2 \Delta y^2
  + \Delta x^2 \Delta z^2
  + \Delta y^2 \Delta z^2) }</span></p>
</div><p>The difference between the current and updated value is termed the <em>normalized
residual</em>:</p>
<div class="math">
<p><span class="math">r_{i_x,i_y,i_z} = \frac{(\epsilon^{n+1}_{i_x,i_y,i_z}
- \epsilon^n_{i_x,i_y,i_z})^2}{(\epsilon^{n+1}_{i_x,i_y,i_z})^2}</span></p>
</div><p>Note that the <span class="math">\epsilon</span> values cannot be 0 due to the above normalization
of the residual.</p>
<p>The updated values are at the end of the iteration stored as the current values,
and the maximal value of the normalized residual is found. If this value is
larger than a tolerance criteria, the procedure is repeated. The iterative
procedure is ended if the number of iterations exceeds a defined limit.</p>
<p>After the values of <span class="math">\epsilon</span> are found, they are used to find the new
pressures and velocities:</p>
<div class="math">
<p><span class="math">\bar{p}^{t+\Delta t} = \beta \bar{p}^t + \epsilon</span></p>
</div><div class="math">
<p><span class="math">\bar{\boldsymbol{v}}^{t+\Delta t} =
\bar{\boldsymbol{v}}^* - \frac{\Delta t}{\rho} \nabla \epsilon</span></p>
</div></div>
<div class="section" id="numerical-implementation">
<h2>Numerical implementation<a class="headerlink" href="#numerical-implementation" title="Permalink to this headline">¶</a></h2>
<p>&#8212;</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Fluid simulation and particle-fluid interaction</a><ul>
<li><a class="reference internal" href="#derivation-of-the-navier-stokes-equations-with-porosity">Derivation of the Navier Stokes equations with porosity</a></li>
<li><a class="reference internal" href="#porosity-estimation">Porosity estimation</a></li>
<li><a class="reference internal" href="#solution-procedure-by-operator-splitting">Solution procedure by operator splitting</a></li>
<li><a class="reference internal" href="#numerical-implementation">Numerical implementation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="dem.html"
                        title="previous chapter">Discrete element method</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="python_api.html"
                        title="next chapter">Python API</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/cfd.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="python_api.html" title="Python API"
             >next</a> |</li>
        <li class="right" >
          <a href="dem.html" title="Discrete element method"
             >previous</a> |</li>
        <li><a href="index.html">sphere 0.35 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Anders Damsgaard.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>